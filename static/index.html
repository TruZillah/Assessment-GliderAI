<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Python Assessment Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #d946ef 100%);
            min-height: 100vh;
            padding: 24px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 24px 48px rgba(0,0,0,0.15), 0 0 0 1px rgba(0,0,0,0.05);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #d946ef 100%);
            color: white;
            padding: 32px 40px;
            text-align: left;
            position: relative;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }
        
        .header h1 {
            font-size: 2.25em;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .header p {
            font-size: 1em;
            opacity: 0.95;
            font-weight: 400;
        }
        
        .language-selector {
            position: absolute;
            top: 32px;
            right: 40px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .language-selector label {
            font-weight: 600;
            font-size: 14px;
            opacity: 0.95;
        }
        
        .language-selector select {
            padding: 10px 16px;
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.25);
            background: rgba(255,255,255,0.15);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 14px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.25s ease;
            min-width: 160px;
        }
        
        .language-selector select:hover {
            background: rgba(255,255,255,0.25);
            border-color: rgba(255,255,255,0.4);
            transform: translateY(-1px);
        }
        
        .language-selector select:focus {
            outline: none;
            background: rgba(255,255,255,0.25);
            border-color: rgba(255,255,255,0.5);
        }
        
        .language-selector select option {
            background: #6366f1;
            color: white;
        }
        
        .help-btn {
            position: absolute;
            top: 32px;
            right: 340px;
            padding: 10px 18px;
            background: rgba(255,255,255,0.15);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            color: #fff;
            border: 2px solid rgba(255,255,255,0.25);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            z-index: 100;
            transition: all 0.25s ease;
        }
        .help-btn:hover { 
            background: rgba(255,255,255,0.25);
            border-color: rgba(255,255,255,0.4);
            transform: translateY(-1px);
        }
        .help-btn:active {
            transform: translateY(0);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 320px 1fr;
            min-height: 700px;
        }
        
        .sidebar {
            background: #f8fafc;
            padding: 24px;
            border-right: 1px solid #e2e8f0;
        }
        
        .sidebar h3 {
            margin-bottom: 16px;
            color: #1e293b;
            font-size: 1.1em;
            font-weight: 700;
        }
        
        .problem-list {
            list-style: none;
        }
        
        .problem-item {
            padding: 14px 16px;
            margin-bottom: 8px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            color: #334155;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        .problem-item:hover {
            border-color: #8b5cf6;
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.15);
        }
        
        .problem-item.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border-color: #6366f1;
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.3);
        }
        
        .difficulty-badge {
            display: inline-block;
            font-size: 0.7em;
            padding: 3px 8px;
            border-radius: 5px;
            margin-left: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .difficulty-easy {
            background: #d1fae5;
            color: #065f46;
        }
        
        .difficulty-medium {
            background: #fef3c7;
            color: #92400e;
        }
        
        .difficulty-hard {
            background: #fecdd3;
            color: #991b1b;
        }
        
        .problem-title {
            font-weight: 600;
            font-size: 0.95em;
        }
        
        .workspace {
            padding: 32px;
            background: #ffffff;
        }
        
        .problem-header {
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .problem-header h2 {
            color: #1e293b;
            margin-bottom: 12px;
            font-weight: 700;
            font-size: 1.8em;
        }
        
        .problem-description {
            color: #475569;
            line-height: 1.7;
            margin-bottom: 20px;
            font-size: 1.05em;
        }
        
        .timer-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: #334155;
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.9em;
            margin-left: 12px;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            border: 1px solid #cbd5e1;
        }
        
        .timer-badge.paused {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #fbbf24;
        }
        
        .timer-controls {
            display: inline-flex;
            gap: 4px;
        }
        
        .timer-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 1.1em;
            transition: all 0.2s ease;
        }
        
        .timer-btn:hover {
            background: rgba(0,0,0,0.1);
            transform: scale(1.1);
        }
        
        /* Time Stats Panel */
        .time-stats-section {
            margin: 20px 0 28px 0;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        
        .time-stats-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 14px 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .time-stats-body {
            padding: 18px 20px;
            background: #ffffff;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 16px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .stat-label {
            color: #64748b;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 6px;
        }
        
        .stat-value {
            color: #1e293b;
            font-size: 1.5em;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }
        
        .session-history {
            margin-top: 20px;
        }
        
        .session-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .session-item:last-child {
            border-bottom: none;
        }
        
        .session-problem {
            font-weight: 600;
            color: #1e293b;
        }
        
        .session-time {
            font-family: 'Courier New', monospace;
            color: #64748b;
        }
        
        .clear-stats-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        
        .clear-stats-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }
        
        /* Notepad Section */
        .notepad-section {
            background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 2px solid #fde047;
            box-shadow: 0 4px 16px rgba(250, 204, 21, 0.15);
        }
        
        .notepad-section h3 {
            margin-bottom: 14px;
            color: #713f12;
            font-weight: 700;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .notepad-textarea {
            width: 100%;
            min-height: 350px;
            padding: 16px;
            border: 2px solid #fde047;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            background: #fffef5;
            color: #422006;
            resize: vertical;
            line-height: 1.6;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .notepad-textarea:focus {
            outline: none;
            border-color: #facc15;
            box-shadow: 0 0 0 3px rgba(250, 204, 21, 0.2);
        }
        
        .notepad-actions {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }
        
        .notepad-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }
        
        .notepad-clear {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .notepad-clear:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }
        
        .notepad-template {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        
        .notepad-template:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        /* Cheat Sheet Section */
        /* Lecture Section Styles */
        .lecture-section {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 2px solid #f59e0b;
            box-shadow: 0 4px 16px rgba(245, 158, 11, 0.2);
        }
        
        .lecture-section h3 {
            margin-bottom: 14px;
            color: #92400e;
            font-weight: 700;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .lecture-content {
            background: #ffffff;
            border: 2px solid #fbbf24;
            border-radius: 8px;
            padding: 20px;
            font-size: 0.95em;
            color: #1e293b;
            line-height: 1.8;
            max-height: 500px;
            overflow-y: auto;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
        }
        
        .lecture-content h4 {
            color: #92400e;
            margin-top: 20px;
            margin-bottom: 12px;
            font-size: 1.15em;
            font-weight: 700;
            border-bottom: 2px solid #fbbf24;
            padding-bottom: 6px;
        }
        
        .lecture-content h4:first-child {
            margin-top: 0;
        }
        
        .lecture-content h5 {
            color: #b45309;
            margin-top: 14px;
            margin-bottom: 8px;
            font-size: 1.05em;
            font-weight: 600;
        }
        
        .lecture-content p {
            margin: 10px 0;
        }
        
        .lecture-content ul, .lecture-content ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        
        .lecture-content li {
            margin: 6px 0;
        }
        
        .lecture-content strong {
            color: #92400e;
            font-weight: 700;
        }
        
        .lecture-content em {
            color: #b45309;
            font-style: italic;
        }
        
        .lecture-content code {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
            color: #92400e;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }
        
        .lecture-content .example-box {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
        }
        
        .lecture-content .tip-box {
            background: #f0fdf4;
            border-left: 4px solid #22c55e;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
        }
        
        .lecture-content .warning-box {
            background: #fef2f2;
            border-left: 4px solid #ef4444;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
        }

        .cheatsheet-section {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 2px solid #60a5fa;
            box-shadow: 0 4px 16px rgba(96, 165, 250, 0.2);
        }
        
        .cheatsheet-section h3 {
            margin-bottom: 14px;
            color: #1e40af;
            font-weight: 700;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cheatsheet-content {
            background: #ffffff;
            border: 2px solid #60a5fa;
            border-radius: 8px;
            padding: 16px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #1e293b;
            line-height: 1.8;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
        }
        
        .cheatsheet-content h4 {
            color: #1e40af;
            margin-top: 16px;
            margin-bottom: 8px;
            font-size: 1.1em;
            font-weight: 700;
            border-bottom: 2px solid #60a5fa;
            padding-bottom: 4px;
        }
        
        .cheatsheet-content h4:first-child {
            margin-top: 0;
        }
        
        .cheatsheet-content code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            color: #7c3aed;
            font-weight: 600;
        }
        
        .cheatsheet-content pre {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 12px;
            margin: 8px 0;
            overflow-x: auto;
            color: #334155;
        }
        
        .cheatsheet-content ul {
            margin: 8px 0;
            padding-left: 20px;
        }
        
        .cheatsheet-content li {
            margin: 4px 0;
        }
        
        .test-cases {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .test-cases h4 {
            margin-bottom: 12px;
            color: #1e293b;
            font-weight: 700;
        }
        
        .editor-section {
            margin-bottom: 24px;
        }
        
        .editor-section h3 {
            margin-bottom: 14px;
            color: #1e293b;
            font-weight: 700;
            font-size: 1.3em;
        }
        .editor-wrapper {
            display: grid;
            grid-template-columns: auto 1fr;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            background: #282c34;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .code-gutter {
            background: #21252b;
            color: #636d83;
            padding: 14px 10px 14px 14px;
            -webkit-user-select: none;
            user-select: none;
            font-weight: 500;
            text-align: right;
            min-width: 46px;
            border-right: 1px solid #3a3f4b;
            overflow: hidden; /* scroll synced via JS */
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        .gutter-line { display: flex; align-items: center; gap: 6px; height: 1.5em; }
        .gutter-num { width: 28px; opacity: 0.8; }
        .gutter-bp { width: 10px; height: 10px; border-radius: 50%; background: transparent; border: 1px solid transparent; cursor: pointer; }
        .gutter-line:hover .gutter-bp { border-color: #9aa0a6; }
        .gutter-bp.set { background: #ff6b6b; border-color: #ff6b6b; }
        
        #code-editor {
            width: 100%;
            min-height: 400px;
            height: 400px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 12px 12px 12px 12px;
            border: none;
            resize: none;
            background: #282c34;
            color: #abb2bf;
            line-height: 1.5;
            outline: none;
            overflow: auto;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .btn {
            padding: 12px 28px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.35);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: #64748b;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #475569;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(100, 116, 139, 0.3);
        }
        
        .btn-secondary:active {
            transform: translateY(0);
        }
        
        .keyboard-hint {
            opacity: 0.7;
            font-size: 0.85em;
            margin-left: 6px;
        }

        /* Syntax docs */
        .syntax-section {
            margin-top: 20px;
        }
        .syntax-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }
        .syntax-toggle {
            padding: 8px 14px;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .syntax-toggle:hover {
            background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.1) 100%);
            transform: translateY(-1px);
        }
        .syntax-body {
            margin-top: 10px;
            padding: 16px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .syntax-body pre {
            margin: 0;
            white-space: pre-wrap;
            line-height: 1.6;
        }

        .results-section {
            margin-top: 24px;
        }

        .hints-section {
            margin: 20px 0 28px 0;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        .hints-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 14px 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        .hints-body {
            padding: 18px 20px;
            background: #ffffff;
        }
        .hints-body pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.6;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
        }
        .hints-title {
            margin: 0;
            color: #1e293b;
            font-weight: 700;
            font-size: 1.1em;
        }
        .hints-bullets {
            margin-left: 20px;
            margin-bottom: 14px;
            color: #475569;
            line-height: 1.7;
        }
        .pseudo-title {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .btn-link {
            background: transparent;
            color: #6366f1;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .btn-link:hover {
            text-decoration: underline;
            color: #4f46e5;
        }
        .pseudo-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .btn-copy {
            padding: 7px 14px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
        }
        .btn-copy:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        .btn-copy:active {
            transform: scale(0.95);
        }
        .btn-copy.copied {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .results-header {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 18px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
        }
        
        .results-summary {
            font-size: 1.15em;
            font-weight: 700;
        }
        
        .results-summary.passed {
            color: #10b981;
        }
        
        .results-summary.failed {
            color: #ef4444;
        }
        
        .test-result {
            padding: 18px 20px;
            margin-bottom: 12px;
            border-radius: 10px;
            border-left: 4px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .test-result:hover {
            transform: translateX(2px);
        }
        
        .test-result.pass {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border-left-color: #10b981;
        }
        
        .test-result.fail {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-left-color: #ef4444;
        }
        
        .test-result-header {
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 1.05em;
        }
        
        .test-detail {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 6px 0;
            line-height: 1.5;
        }
        
        .error-box {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border: 2px solid #fca5a5;
            color: #991b1b;
            padding: 18px 20px;
            border-radius: 10px;
            margin-bottom: 24px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.15);
        }
        
        .loading {
            text-align: center;
            padding: 24px;
            color: #64748b;
            font-weight: 500;
        }
        
        .hidden {
            display: none;
        }

        /* Debugger styles */
        .debug-section {
            margin: 20px 0 28px 0;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        .debug-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 14px 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        .debug-body {
            padding: 18px 20px;
            background: #ffffff;
        }
        .debug-controls { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 16px; }
        .debug-controls .full { grid-column: 1 / -1; }
        .debug-select, .debug-input {
            width: 100%; padding: 10px 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.95em;
            transition: border-color 0.2s ease;
        }
        .debug-select:focus, .debug-input:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        .debug-run {
            padding: 12px 20px; background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white; border: none; 
            border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
        }
        .debug-run:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4);
        }
        .trace-step { 
            padding: 14px; border-left: 4px solid #e2e8f0; background: #f8fafc; border-radius: 8px; margin-bottom: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.04);
        }
        .trace-line { font-family: 'Courier New', monospace; margin-bottom: 8px; line-height: 1.5; }
        .locals-grid { display: grid; grid-template-columns: max-content 1fr; gap: 8px 16px; }
        .locals-key { font-weight: 600; color: #1e293b; }
        .locals-val { font-family: 'Courier New', monospace; color: #475569; }
    .trace-nav { display: flex; gap: 10px; align-items: center; margin: 10px 0; }
    .flex-row { display: flex; gap: 12px; align-items: center; }
        .btn-small { 
            padding: 7px 12px; border-radius: 8px; border: none; cursor: pointer; 
            background: #64748b; color: #fff; font-weight: 600; transition: all 0.2s ease;
        }
        .btn-small:hover { 
            background: #475569;
            transform: translateY(-1px);
        }

        /* Glossary styles */
        .glossary-section {
            margin: 20px 0 28px 0;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        .glossary-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 14px 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        .glossary-body {
            padding: 18px 20px;
            background: #ffffff;
        }
        .glossary-search {
            width: 100%;
            padding: 10px 14px;
            margin-bottom: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.95em;
            transition: border-color 0.2s ease;
        }
        .glossary-search:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        .glossary-item {
            padding: 14px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .glossary-item:last-child { border-bottom: none; }
        .term-title {
            font-weight: 700;
            color: #1e293b;
            font-size: 1.05em;
        }
        .term-definition {
            color: #475569;
            margin-top: 6px;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        .term-actions {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }

        /* Onboarding tour */
        .tour-overlay { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 1000; 
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }
        .tour-card { 
            background: #fff; border-radius: 16px; padding: 24px 28px; width: min(600px, 92vw); 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .tour-text { color: #1e293b; margin-bottom: 16px; line-height: 1.6; font-size: 1.05em; }
        .tour-actions { display: flex; justify-content: space-between; align-items: center; }
        .tour-actions-right { display: flex; gap: 12px; }
        .btn-ghost { 
            background: transparent; border: 2px solid #e2e8f0; color: #64748b; 
            padding: 10px 18px; border-radius: 8px; cursor: pointer; font-weight: 600;
            transition: all 0.2s ease;
        }
        .btn-ghost:hover { 
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        .btn-primary-small { 
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); 
            border: none; color: #fff; padding: 10px 18px; border-radius: 8px; cursor: pointer; font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
        }
        .btn-primary-small:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        .tour-highlight { outline: 3px solid #fbbf24; outline-offset: 4px; border-radius: 8px; transition: outline-color 0.2s ease; }

        /* AI Assistant */
        .ai-section { 
            margin: 20px 0 28px 0; border: 2px solid #e2e8f0; border-radius: 12px; overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        .ai-header { 
            display: flex; align-items: center; justify-content: space-between; 
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); 
            padding: 14px 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        .ai-body { padding: 18px 20px; background: #ffffff; }
        .ai-controls { display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 16px; }
        .ai-row { display: flex; flex-wrap: wrap; gap: 14px; align-items: center; }
        .ai-textarea { 
            width: 100%; min-height: 90px; resize: vertical; padding: 12px 14px; 
            border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.95em;
            transition: border-color 0.2s ease;
            line-height: 1.5;
        }
        .ai-textarea:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        .ai-run { 
            padding: 12px 20px; background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%); 
            color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(168, 85, 247, 0.3);
        }
        .ai-run:hover { 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(168, 85, 247, 0.4);
        }
        .ai-output { border-top: 2px solid #e2e8f0; padding-top: 16px; margin-top: 16px; }
        .ai-answer { 
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); 
            border: 1px solid #e2e8f0; border-radius: 10px; padding: 16px; white-space: pre-wrap; 
            color: #1e293b; line-height: 1.6;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.04);
        }
        .ai-actions { display: flex; gap: 10px; align-items: center; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ÔøΩ Multi-Language Assessment Practice</h1>
            <p>Select a problem, write your solution, and test it instantly</p>
            <div class="language-selector">
                <label for="language-select">Language:</label>
                <select id="language-select">
                    <option value="python">Python üêç</option>
                    <option value="javascript">JavaScript üìú</option>
                    <option value="java">Java ‚òï</option>
                    <option value="cpp">C++ ‚ö°</option>
                </select>
            </div>
            <button id="open-tour" class="help-btn">‚ùì Help & Tour</button>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <h3>Problems</h3>
                <ul class="problem-list" id="problem-list">
                    <li class="loading">Loading problems...</li>
                </ul>
            </div>
            
            <div class="workspace">
                <div id="problem-view" class="hidden">
                    <div class="problem-header">
                        <h2 id="problem-title">
                            <span id="problem-title-text">Select a problem</span>
                            <span class="timer-badge" id="timer-badge">
                                <span id="timer">‚è±Ô∏è 00:00</span>
                                <div class="timer-controls">
                                    <button id="timer-pause" class="timer-btn" title="Pause timer">‚è∏</button>
                                    <button id="timer-reset" class="timer-btn" title="Reset timer">‚Üª</button>
                                </div>
                            </span>
                        </h2>
                        <p class="problem-description" id="problem-description"></p>
                    </div>
                    
                    <div id="test-cases-section" class="test-cases hidden">
                        <h4>Sample Test Cases:</h4>
                        <div id="test-cases"></div>
                    </div>

                    <!-- Notepad Section -->
                    <div class="notepad-section hidden" id="notepad-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px;">
                            <h3>üìù Problem-Solving Notepad</h3>
                            <button class="btn-link" id="toggle-notepad">Hide notepad</button>
                        </div>
                        <div id="notepad-body">
                            <textarea id="notepad-textarea" class="notepad-textarea" placeholder="Use this notepad to work through the problem..."></textarea>
                            <div class="notepad-actions">
                                <button class="notepad-btn notepad-template" id="load-template">üìã Load Template</button>
                                <button class="notepad-btn notepad-clear" id="clear-notepad">üóëÔ∏è Clear Notes</button>
                            </div>
                        </div>
                    </div>

                    <!-- Cheat Sheet Section -->
                    <div class="cheatsheet-section hidden" id="cheatsheet-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px;">
                            <h3 id="cheatsheet-title">üìö Cheat Sheet</h3>
                            <button class="btn-link" id="toggle-cheatsheet">Hide cheat sheet</button>
                        </div>
                        <div id="cheatsheet-body">
                            <div id="cheatsheet-content" class="cheatsheet-content"></div>
                        </div>
                    </div>

                    <!-- Lecture Section -->
                    <div class="lecture-section hidden" id="lecture-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px;">
                            <h3>üéì Problem-Solving Lecture</h3>
                            <button class="btn-link" id="toggle-lecture">Hide lecture</button>
                        </div>
                        <div id="lecture-body" class="lecture-content">
                            <!-- Content will be dynamically loaded here -->
                        </div>
                    </div>

                    <div class="hints-section hidden" id="hints-section">
                        <div class="hints-header">
                            <h3 class="hints-title">üí° Hints</h3>
                            <button class="btn-link" id="toggle-hints">Show hints</button>
                        </div>
                        <div class="hints-body hidden" id="hints-body">
                            <ul id="hints-bullets" class="hints-bullets"></ul>
                            <div>
                                <div class="pseudo-header">
                                    <div class="pseudo-title">Pseudocode</div>
                                    <button class="btn-copy" id="copy-pseudo-btn" title="Copy the pseudocode to your clipboard">üìã Copy</button>
                                </div>
                                <pre id="hints-pseudocode"></pre>
                            </div>
                        </div>
                    </div>
                    
                    <div class="editor-section">
                        <h3>Your Solution:</h3>
                        <div class="editor-wrapper">
                            <div id="code-gutter" class="code-gutter"></div>
                            <textarea id="code-editor" spellcheck="false" title="Write your solution here. Use Tab to indent."></textarea>
                        </div>
                    </div>
                    
                    <div class="debug-section" id="debug-section">
                        <div class="debug-header">
                            <h3 class="hints-title">ü™≤ Debugger</h3>
                            <button class="btn-link" id="toggle-debug">Show debugger</button>
                        </div>
                        <div class="debug-body hidden" id="debug-body">
                            <div class="debug-controls">
                                <div>
                                    <label for="debug-test" class="pseudo-title">Test case</label>
                                    <select id="debug-test" class="debug-select"></select>
                                </div>
                                <div>
                                    <label for="debug-bps" class="pseudo-title">Breakpoints (lines)</label>
                                    <input id="debug-bps" class="debug-input" placeholder="e.g., 3,7,12" />
                                </div>
                                <div class="full">
                                    <label for="debug-custom" class="pseudo-title">Custom args (JSON array) ‚Äî optional</label>
                                    <input id="debug-custom" class="debug-input" placeholder='e.g., ["abc", 2, [1,2]]' />
                                </div>
                                <div class="full flex-row">
                                    <button id="debug-run" class="debug-run" title="Run the debugger with the selected test or custom args">‚ñ∂ Run Debug</button>
                                    <button id="debug-guide" class="btn-small">Guide me</button>
                                    <div id="debug-meta" class="keyboard-hint"></div>
                                </div>
                            </div>
                            <div id="debug-output"></div>
                        </div>
                    </div>

                    <div class="glossary-section hidden" id="glossary-section">
                        <div class="glossary-header">
                            <h3 class="hints-title">üìö Glossary</h3>
                            <button class="btn-link" id="toggle-glossary">Show glossary</button>
                        </div>
                        <div class="glossary-body hidden" id="glossary-body">
                            <input type="text" id="glossary-search" class="glossary-search" placeholder="Filter terms... (e.g., sliding window)">
                            <div id="glossary-list"></div>
                        </div>
                    </div>

                    <div class="ai-section" id="ai-section">
                        <div class="ai-header">
                            <h3 class="hints-title">ü§ñ AI Assistant</h3>
                            <button class="btn-link" id="toggle-ai">Show assistant</button>
                        </div>
                        <div class="ai-body hidden" id="ai-body">
                            <div class="ai-controls">
                                <textarea id="ai-prompt" class="ai-textarea" placeholder="Ask a question about the current problem or your code..."></textarea>
                                <div class="ai-row">
                                    <label><input type="checkbox" id="ai-inc-desc" checked> Include description</label>
                                    <label><input type="checkbox" id="ai-inc-code" checked> Include my code</label>
                                    <label><input type="checkbox" id="ai-inc-tests" checked> Include sample tests</label>
                                    <label><input type="checkbox" id="ai-inc-hints"> Include hints/pseudocode</label>
                                </div>
                                <div class="ai-row">
                                    <button id="ai-ask" class="ai-run" title="Send your question to the AI assistant">Ask AI</button>
                                    <div id="ai-meta" class="keyboard-hint"></div>
                                </div>
                            </div>
                            <div class="ai-output" id="ai-output"></div>
                        </div>
                    </div>

                    <div class="time-stats-section" id="time-stats-section">
                        <div class="time-stats-header">
                            <h3 class="hints-title">‚è±Ô∏è Time Tracking</h3>
                            <button class="btn-link" id="toggle-time-stats">Show stats</button>
                        </div>
                        <div class="time-stats-body hidden" id="time-stats-body">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-label">Current Session</div>
                                    <div class="stat-value" id="stat-current">--:--</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Total Time</div>
                                    <div class="stat-value" id="stat-total">--:--</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Problems Solved</div>
                                    <div class="stat-value" id="stat-solved">0</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Avg Time/Problem</div>
                                    <div class="stat-value" id="stat-avg">--:--</div>
                                </div>
                            </div>
                            <div class="session-history">
                                <h4 style="margin-bottom: 12px; color: #1e293b;">Recent Sessions</h4>
                                <div id="session-history-list"></div>
                                <button class="clear-stats-btn" id="clear-stats-btn" style="margin-top: 16px;">Clear All History</button>
                            </div>
                        </div>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-primary" id="submit-btn" title="Run tests for the selected problem (Ctrl+Enter)">‚ñ∂ Run Tests <span class="keyboard-hint">(Ctrl+Enter)</span></button>
                        <button class="btn btn-secondary" id="reset-btn" title="Reset the editor to the original problem stub">‚Ü∫ Reset Code</button>
                    </div>
                    
                    <div id="results-section" class="results-section hidden">
                        <div class="results-header">
                            <div class="results-summary" id="results-summary"></div>
                        </div>
                        <div id="test-results"></div>
                    </div>
                </div>
                
                <div id="welcome-message">
                    <h2>Welcome to Python Practice!</h2>
                    <p>Select a problem from the sidebar to get started.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Onboarding Tour Overlay -->
    <div id="tour-overlay" class="tour-overlay hidden" style="display: none;">
        <div class="tour-card">
            <div class="tour-text" id="tour-text"></div>
            <div class="tour-actions">
                <button id="tour-skip" type="button" class="btn-ghost">Skip</button>
                <div class="tour-actions-right">
                    <button id="tour-prev" type="button" class="btn-ghost">Prev</button>
                    <button id="tour-next" type="button" class="btn-primary-small">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentProblem = null;
        let originalStub = '';
        let currentHints = null;
        let hintVisibilityState = {}; // Remember hint visibility per problem
        let timerInterval = null;
        let timerSeconds = 0;
        let timerPaused = false;
        let problemStartTime = null;
        let timeHistory = JSON.parse(localStorage.getItem('timeHistory') || '[]');
        let glossaryCache = null; // Cache of all terms
        let glossaryVisibleState = false; // single toggle
        let debugTrace = [];
        let debugIndex = 0;
        let editorBps = new Set();
        let currentLanguage = localStorage.getItem('selectedLanguage') || 'python';
        
        // Notepad variables
        let notepadVisible = true; // Start visible by default
        
        // Problem-solving template
        const PROBLEM_SOLVING_TEMPLATE = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë              PROBLEM-SOLVING FRAMEWORK                    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

1Ô∏è‚É£  UNDERSTAND THE PROBLEM
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
What is the problem asking?


What are the inputs?


What are the outputs?


What are the constraints?


2Ô∏è‚É£  EXAMPLES & EDGE CASES
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Example 1:


Example 2:


Edge cases to consider:
- Empty input?
- Single element?
- Negative numbers?
- Duplicates?
- Very large input?


3Ô∏è‚É£  APPROACH & ALGORITHM
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Initial thoughts:


Possible approaches:
1. 

2. 

3. 


Chosen approach:


Why this approach?


4Ô∏è‚É£  DATA STRUCTURES
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
What data structures will I use?


Why these data structures?


5Ô∏è‚É£  STEP-BY-STEP ALGORITHM
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1. 

2. 

3. 

4. 

5. 


6Ô∏è‚É£  COMPLEXITY ANALYSIS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Time Complexity: O(?)
Explanation:


Space Complexity: O(?)
Explanation:


7Ô∏è‚É£  IMPLEMENTATION NOTES
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Key points to remember while coding:


Potential pitfalls to avoid:


8Ô∏è‚É£  TESTING & VERIFICATION
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Test cases to verify:


What to check after implementation:
`;
        
        // Cheat sheets for each language
        const CHEAT_SHEETS = {
            python: `<h4>üêç Python Quick Reference for Beginners</h4>

<strong>üìå Basic Syntax & Variables:</strong>
<pre># Variables (no type declaration needed!)
name = "Alice"         # String
age = 25               # Integer
height = 5.8           # Float
is_student = True      # Boolean (note capital T/F)

# Multiple assignment
x, y, z = 1, 2, 3

# Print output
print("Hello World")
print(f"My name is {name}")  # f-string (formatted)
print(name, age)             # Multiple values</pre>

<strong>üîÑ Conditional Statements:</strong>
<pre># If-elif-else (note the colons and indentation!)
if age &gt;= 18:
    print("Adult")
elif age &gt;= 13:
    print("Teenager")
else:
    print("Child")

# Comparison operators: ==, !=, &lt;, &gt;, &lt;=, &gt;=
# Logical operators: and, or, not
if age &gt; 18 and is_student:
    print("Adult student")

# Ternary operator (one-line if)
status = "Adult" if age &gt;= 18 else "Minor"</pre>

<strong>üîÅ Loops Explained:</strong>
<pre># FOR LOOP - Use when you know how many times to loop
# Loop through a range of numbers
for i in range(5):        # 0, 1, 2, 3, 4
    print(i)

for i in range(2, 10):    # 2, 3, 4, 5, 6, 7, 8, 9
    print(i)

for i in range(0, 10, 2): # 0, 2, 4, 6, 8 (step by 2)
    print(i)

# Loop through a list
fruits = ["apple", "banana", "cherry"]
for fruit in fruits:
    print(fruit)

# Loop with index and value
for i, fruit in enumerate(fruits):
    print(f"{i}: {fruit}")  # 0: apple, 1: banana, ...

# WHILE LOOP - Use when you don't know how many iterations
count = 0
while count &lt; 5:
    print(count)
    count += 1            # count = count + 1

# Loop control
for i in range(10):
    if i == 3:
        continue          # Skip rest of this iteration
    if i == 7:
        break             # Exit loop entirely
    print(i)</pre>

<strong>üì¶ Lists (Arrays) - Most Common Data Structure:</strong>
<pre># Creating lists
arr = [1, 2, 3, 4, 5]
mixed = [1, "hello", True, 3.14]  # Can mix types
empty = []

# Accessing elements (0-indexed!)
first = arr[0]         # 1
last = arr[-1]         # 5 (negative index from end)

# Modifying
arr[0] = 10            # Change element
arr.append(6)          # Add to end ‚Üí [10,2,3,4,5,6]
arr.insert(0, 0)       # Insert at position 0
arr.pop()              # Remove & return last element
arr.remove(3)          # Remove first occurrence of value 3

# List operations
len(arr)               # Get length
arr.sort()             # Sort in place
sorted(arr)            # Return new sorted list
arr.reverse()          # Reverse in place
3 in arr               # Check if 3 exists ‚Üí True/False

# Slicing [start:end:step]
arr[1:4]               # Elements 1,2,3 (end not included)
arr[:3]                # First 3 elements
arr[2:]                # From index 2 to end
arr[::2]               # Every other element

# List comprehension (create lists in one line)
squares = [x**2 for x in range(5)]  # [0,1,4,9,16]
evens = [x for x in arr if x % 2 == 0]  # Filter evens</pre>

<strong>üìñ Dictionaries (Hash Maps) - Key-Value Pairs:</strong>
<pre># Creating dictionaries
person = {"name": "Alice", "age": 25, "city": "NYC"}
empty_dict = {}

# Accessing values
name = person["name"]           # "Alice"
age = person.get("age", 0)      # Safer - returns 0 if not found

# Modifying
person["age"] = 26              # Update existing
person["job"] = "Engineer"      # Add new key

# Checking & removing
if "name" in person:            # Check if key exists
    print(person["name"])
del person["city"]              # Remove key-value pair

# Looping through dictionary
for key in person:
    print(key, person[key])

for key, value in person.items():
    print(f"{key}: {value}")

# Dictionary operations
person.keys()                   # Get all keys
person.values()                 # Get all values
person.items()                  # Get key-value pairs</pre>

<strong>üéØ Sets - Unique Values Only:</strong>
<pre># Creating sets (no duplicates!)
s = {1, 2, 3, 3, 3}    # Results in {1, 2, 3}
empty_set = set()      # NOT {} (that's a dict!)

# Operations
s.add(4)               # Add element
s.remove(2)            # Remove (error if not exists)
s.discard(2)           # Remove (no error if not exists)
1 in s                 # Check membership - O(1) fast!

# Set operations
a = {1, 2, 3}
b = {3, 4, 5}
a | b                  # Union: {1,2,3,4,5}
a & b                  # Intersection: {3}
a - b                  # Difference: {1,2}</pre>

<strong>‚úÇÔ∏è Strings - Text Manipulation:</strong>
<pre># Creating strings
s = "Hello World"
s = 'Also works'
multi = """Multiple
lines"""

# Common operations
s.upper()              # "HELLO WORLD"
s.lower()              # "hello world"
s.strip()              # Remove whitespace from ends
s.replace("World", "Python")  # "Hello Python"
s.split(" ")           # ["Hello", "World"] - split into list
"-".join(["a","b"])    # "a-b" - join list to string

# String checks
s.startswith("Hello")  # True
s.endswith("d")        # True
s.isalpha()            # All letters?
s.isdigit()            # All numbers?
"ll" in s              # Check substring

# String indexing (like lists)
s[0]                   # "H"
s[-1]                  # "d"
s[0:5]                 # "Hello"

# Converting
str(123)               # "123" - number to string
int("123")             # 123 - string to number</pre>

<strong>üî¢ Math & Numbers:</strong>
<pre># Basic operators
+  -  *  /             # Add, subtract, multiply, divide
//                     # Integer division: 7 // 2 = 3
%                      # Modulo (remainder): 7 % 2 = 1
**                     # Power: 2**3 = 8

# Built-in math
abs(-5)                # 5 (absolute value)
min(1, 2, 3)           # 1
max(1, 2, 3)           # 3
sum([1, 2, 3])         # 6
round(3.7)             # 4
pow(2, 3)              # 8 (same as 2**3)

# Useful functions
len([1,2,3])           # 3 (length of list/string)
range(5)               # 0,1,2,3,4
sorted([3,1,2])        # [1,2,3]
reversed([1,2,3])      # [3,2,1]</pre>

<strong>üõ†Ô∏è Functions - Reusable Code Blocks:</strong>
<pre># Defining functions
def greet(name):
    return f"Hello, {name}"

result = greet("Alice")  # "Hello, Alice"

# Multiple parameters
def add(a, b):
    return a + b

# Default parameters
def greet(name="Guest"):
    return f"Hello, {name}"

greet()                # "Hello, Guest"
greet("Alice")         # "Hello, Alice"

# Multiple return values
def get_stats():
    return 10, 20, 30

x, y, z = get_stats()  # x=10, y=20, z=30</pre>

<strong>üí° Common Patterns for Coding Problems:</strong>
<pre># Pattern 1: Two Pointers (for sorted arrays)
left, right = 0, len(arr) - 1
while left &lt; right:
    if arr[left] + arr[right] == target:
        return [left, right]
    elif arr[left] + arr[right] &lt; target:
        left += 1
    else:
        right -= 1

# Pattern 2: Frequency Counter (count occurrences)
freq = {}
for item in arr:
    freq[item] = freq.get(item, 0) + 1
# or use Counter:
from collections import Counter
freq = Counter(arr)

# Pattern 3: Sliding Window (subarray problems)
window_sum = 0
for i in range(len(arr)):
    window_sum += arr[i]
    if i &gt;= window_size:
        window_sum -= arr[i - window_size]

# Pattern 4: Using a Stack (LIFO - Last In First Out)
stack = []
stack.append(item)     # Push
top = stack.pop()      # Pop
peek = stack[-1]       # Look at top without removing

# Pattern 5: Using a Queue (FIFO - First In First Out)
from collections import deque
queue = deque()
queue.append(item)     # Enqueue
first = queue.popleft() # Dequeue</pre>`,

            javascript: `<h4>üìú JavaScript Quick Reference for Beginners</h4>

<strong>üìå Basic Syntax & Variables:</strong>
<pre>// Variables (3 ways to declare)
let name = "Alice";    // Block-scoped, can reassign
const age = 25;        // Block-scoped, CANNOT reassign
var old = "avoid";     // Function-scoped, use let/const instead

// Data types
let str = "Hello";     // String
let num = 42;          // Number
let decimal = 3.14;    // Also Number
let bool = true;       // Boolean (true/false lowercase)
let nothing = null;    // Null
let undef;             // Undefined

// Print output
console.log("Hello World");
console.log(\`My name is \${name}\`);  // Template literal (backticks)
console.log(name, age);                // Multiple values</pre>

<strong>üîÑ Conditional Statements:</strong>
<pre>// If-else (note: use curly braces!)
if (age >= 18) {
    console.log("Adult");
} else if (age >= 13) {
    console.log("Teenager");
} else {
    console.log("Child");
}

// Comparison: ===, !==, &lt;, &gt;, &lt;=, &gt;= (use === not ==)
// Logical: &&, ||, !
if (age > 18 && isStudent) {
    console.log("Adult student");
}

// Ternary operator
const status = age >= 18 ? "Adult" : "Minor";

// Switch statement
switch(day) {
    case "Monday":
        console.log("Start of week");
        break;
    case "Friday":
        console.log("TGIF!");
        break;
    default:
        console.log("Regular day");
}</pre>

<strong>üîÅ Loops Explained:</strong>
<pre>// FOR LOOP - Most common, use when you know iterations
for (let i = 0; i &lt; 5; i++) {
    console.log(i);    // 0, 1, 2, 3, 4
}

// Loop through array
const fruits = ["apple", "banana", "cherry"];
for (let i = 0; i &lt; fruits.length; i++) {
    console.log(fruits[i]);
}

// FOR...OF - Loop through array values (easier!)
for (const fruit of fruits) {
    console.log(fruit);  // apple, banana, cherry
}

// FOR...IN - Loop through object keys
const person = {name: "Alice", age: 25};
for (const key in person) {
    console.log(key, person[key]);
}

// WHILE LOOP - When you don't know iterations
let count = 0;
while (count &lt; 5) {
    console.log(count);
    count++;           // count = count + 1
}

// DO-WHILE - Runs at least once
let i = 0;
do {
    console.log(i);
    i++;
} while (i &lt; 5);

// Loop control
for (let i = 0; i &lt; 10; i++) {
    if (i === 3) continue;  // Skip this iteration
    if (i === 7) break;     // Exit loop
    console.log(i);
}</pre>

<strong>üì¶ Arrays - Most Common Data Structure:</strong>
<pre>// Creating arrays
let arr = [1, 2, 3, 4, 5];
let mixed = [1, "hello", true, 3.14];  // Can mix types
let empty = [];

// Accessing (0-indexed!)
let first = arr[0];        // 1
let last = arr[arr.length - 1];  // 5

// Modifying
arr[0] = 10;               // Change element
arr.push(6);               // Add to end ‚Üí [10,2,3,4,5,6]
arr.pop();                 // Remove from end, returns value
arr.unshift(0);            // Add to start (slower)
arr.shift();               // Remove from start (slower)
arr.splice(2, 1);          // Remove 1 element at index 2

// Array properties & methods
arr.length;                // Get length
arr.includes(3);           // Check if 3 exists ‚Üí true/false
arr.indexOf(3);            // Find index of 3 (-1 if not found)

// Slicing (doesn't modify original)
arr.slice(1, 4);           // Get elements 1,2,3 (end not included)
arr.slice(2);              // From index 2 to end

// Sorting
arr.sort();                // Sorts as strings! ‚ö†Ô∏è
arr.sort((a, b) => a - b); // Numeric ascending
arr.sort((a, b) => b - a); // Numeric descending

// Modern array methods (very powerful!)
arr.map(x => x * 2);       // Transform each element
arr.filter(x => x > 0);    // Keep only matching elements
arr.reduce((sum, x) => sum + x, 0);  // Reduce to single value
arr.forEach(x => console.log(x));    // Loop through

// Finding
arr.find(x => x > 3);      // First element &gt; 3
arr.findIndex(x => x > 3); // Index of first match

// Combining
const arr2 = [6, 7, 8];
const combined = [...arr, ...arr2];  // Spread operator
const joined = arr.concat(arr2);     // Also works</pre>

<strong>üìñ Objects - Key-Value Pairs:</strong>
<pre>// Creating objects
const person = {
    name: "Alice",
    age: 25,
    city: "NYC"
};
const empty = {};

// Accessing values (2 ways)
let name = person.name;           // Dot notation
let age = person["age"];          // Bracket notation

// Modifying
person.age = 26;                  // Update
person.job = "Engineer";          // Add new property
delete person.city;               // Remove property

// Checking
if ("name" in person) {           // Check if key exists
    console.log(person.name);
}
if (person.hasOwnProperty("age")) {
    console.log(person.age);
}

// Looping through object
for (const key in person) {
    console.log(key, person[key]);
}

// Object methods (ES6+)
Object.keys(person);              // ["name", "age", "job"]
Object.values(person);            // ["Alice", 26, "Engineer"]
Object.entries(person);           // [["name","Alice"], ...]

// Destructuring (extract values)
const {name, age} = person;       // Creates name & age variables</pre>

<strong>üéØ Map & Set - Modern Data Structures:</strong>
<pre>// Map (better than objects for hash maps)
const map = new Map();
map.set("key", "value");   // Add/update
map.get("key");            // "value"
map.has("key");            // Check existence ‚Üí true
map.delete("key");         // Remove
map.size;                  // Get size

// Loop through Map
for (const [key, value] of map) {
    console.log(key, value);
}

// Set (unique values only!)
const set = new Set([1, 2, 3, 3, 3]);  // Results in {1, 2, 3}
set.add(4);                // Add element
set.delete(2);             // Remove element
set.has(1);                // Check membership - O(1) fast!
set.size;                  // Get size

// Convert Set to Array
const arr = [...set];
const arr2 = Array.from(set);</pre>

<strong>‚úÇÔ∏è Strings - Text Manipulation:</strong>
<pre>// Creating strings
let s = "Hello World";
let s2 = 'Also works';
let s3 = \`Template \${s}\`;  // Template literals (backticks)

// Common operations
s.toUpperCase();           // "HELLO WORLD"
s.toLowerCase();           // "hello world"
s.trim();                  // Remove whitespace from ends
s.replace("World", "JS");  // "Hello JS"
s.split(" ");              // ["Hello", "World"]
arr.join("-");             // Join array: "Hello-World"

// String checks
s.startsWith("Hello");     // true
s.endsWith("d");           // true
s.includes("llo");         // true
s.charAt(0);               // "H"
s[0];                      // "H" (simpler)

// Substring
s.substring(0, 5);         // "Hello"
s.slice(0, 5);             // "Hello" (same but allows negative)
s.slice(-5);               // "World" (last 5 chars)

// Converting
String(123);               // "123"
Number("123");             // 123
parseInt("123");           // 123
parseFloat("3.14");        // 3.14</pre>

<strong>üî¢ Math & Numbers:</strong>
<pre>// Basic operators
+  -  *  /                 // Add, subtract, multiply, divide
%                          // Modulo: 7 % 2 = 1
**                         // Power: 2**3 = 8
++  --                     // Increment, decrement

// Math object
Math.abs(-5);              // 5
Math.min(1, 2, 3);         // 1
Math.max(1, 2, 3);         // 3
Math.floor(3.7);           // 3 (round down)
Math.ceil(3.2);            // 4 (round up)
Math.round(3.5);           // 4 (round nearest)
Math.pow(2, 3);            // 8 (or 2**3)
Math.sqrt(16);             // 4
Math.random();             // Random 0-1

// Array math
Math.min(...arr);          // Min value in array
Math.max(...arr);          // Max value in array

// Type checking
typeof "hello";            // "string"
typeof 42;                 // "number"
typeof true;               // "boolean"
Array.isArray([1,2,3]);    // true</pre>

<strong>üõ†Ô∏è Functions - Reusable Code:</strong>
<pre>// Function declaration
function greet(name) {
    return \`Hello, \${name}\`;
}

// Function expression
const greet2 = function(name) {
    return \`Hello, \${name}\`;
};

// Arrow function (modern, shorter)
const greet3 = (name) => {
    return \`Hello, \${name}\`;
};
const greet4 = name => \`Hello, \${name}\`;  // Even shorter!

// Multiple parameters
const add = (a, b) => a + b;

// Default parameters
const greet5 = (name = "Guest") => \`Hello, \${name}\`;

// Rest parameters (variable args)
const sum = (...nums) => nums.reduce((a, b) => a + b, 0);
sum(1, 2, 3, 4);           // 10</pre>

<strong>üí° Common Patterns for Coding Problems:</strong>
<pre>// Pattern 1: Two Pointers
let left = 0, right = arr.length - 1;
while (left &lt; right) {
    if (arr[left] + arr[right] === target) {
        return [left, right];
    } else if (arr[left] + arr[right] &lt; target) {
        left++;
    } else {
        right--;
    }
}

// Pattern 2: Frequency Counter
const freq = {};
for (const item of arr) {
    freq[item] = (freq[item] || 0) + 1;
}
// Or use Map
const freqMap = new Map();
for (const item of arr) {
    freqMap.set(item, (freqMap.get(item) || 0) + 1);
}

// Pattern 3: Sliding Window
let windowSum = 0;
for (let i = 0; i &lt; arr.length; i++) {
    windowSum += arr[i];
    if (i >= windowSize) {
        windowSum -= arr[i - windowSize];
    }
}

// Pattern 4: Stack (LIFO)
const stack = [];
stack.push(item);          // Push
const top = stack.pop();   // Pop
const peek = stack[stack.length - 1];  // Peek

// Pattern 5: Queue (FIFO)
const queue = [];
queue.push(item);          // Enqueue
const first = queue.shift();  // Dequeue (slow but simple)

// Pattern 6: Remove duplicates (using Set)
const unique = [...new Set(arr)];

// Pattern 7: Find max/min
const max = Math.max(...arr);
const min = Math.min(...arr);</pre>`,

            java: `<h4>‚òï Java Quick Reference for Beginners</h4>

<strong>üìå Basic Syntax & Variables:</strong>
<pre>// Variables (must declare type!)
String name = "Alice";      // String
int age = 25;               // Integer
double height = 5.8;        // Decimal number
boolean isStudent = true;   // Boolean (lowercase)
char letter = 'A';          // Single character

// Constants (cannot change)
final int MAX_SIZE = 100;

// Print output
System.out.println("Hello World");
System.out.println("Name: " + name);  // Concatenation
System.out.printf("Age: %d\\n", age);  // Formatted output</pre>

<strong>üîÑ Conditional Statements:</strong>
<pre>// If-else (must use curly braces for multiple statements)
if (age >= 18) {
    System.out.println("Adult");
} else if (age >= 13) {
    System.out.println("Teenager");
} else {
    System.out.println("Child");
}

// Comparison: ==, !=, &lt;, &gt;, &lt;=, &gt;=
// Logical: &&, ||, !
if (age > 18 && isStudent) {
    System.out.println("Adult student");
}

// Ternary operator
String status = (age >= 18) ? "Adult" : "Minor";

// Switch statement
switch(day) {
    case "Monday":
        System.out.println("Start of week");
        break;
    case "Friday":
        System.out.println("TGIF!");
        break;
    default:
        System.out.println("Regular day");
}</pre>

<strong>üîÅ Loops Explained:</strong>
<pre>// FOR LOOP - Most common
for (int i = 0; i &lt; 5; i++) {
    System.out.println(i);  // 0, 1, 2, 3, 4
}

// Loop through array
int[] numbers = {1, 2, 3, 4, 5};
for (int i = 0; i &lt; numbers.length; i++) {
    System.out.println(numbers[i]);
}

// ENHANCED FOR LOOP (for-each) - Easier!
String[] fruits = {"apple", "banana", "cherry"};
for (String fruit : fruits) {
    System.out.println(fruit);
}

// WHILE LOOP - When you don't know iterations
int count = 0;
while (count &lt; 5) {
    System.out.println(count);
    count++;           // count = count + 1
}

// DO-WHILE - Runs at least once
int i = 0;
do {
    System.out.println(i);
    i++;
} while (i &lt; 5);

// Loop control
for (int i = 0; i &lt; 10; i++) {
    if (i == 3) continue;  // Skip this iteration
    if (i == 7) break;     // Exit loop
    System.out.println(i);
}</pre>

<strong>üì¶ Arrays - Fixed Size:</strong>
<pre>// Creating arrays (size cannot change!)
int[] arr = {1, 2, 3, 4, 5};
int[] arr2 = new int[10];    // Empty array of size 10
String[] names = {"Alice", "Bob"};

// Accessing (0-indexed!)
int first = arr[0];          // 1
int last = arr[arr.length - 1];  // 5

// Modifying
arr[0] = 10;                 // Change element

// Array properties
arr.length;                  // Get length (property, not method!)

// Sorting arrays
Arrays.sort(arr);            // Sort ascending
Arrays.sort(arr, Collections.reverseOrder());  // Descending (only for Integer[])

// Common operations (need Arrays class)
Arrays.toString(arr);        // "[1, 2, 3, 4, 5]"
Arrays.fill(arr, 0);         // Fill all with 0
Arrays.copyOf(arr, arr.length);  // Copy array

// 2D Arrays
int[][] matrix = {
    {1, 2, 3},
    {4, 5, 6}
};
int val = matrix[0][1];      // 2</pre>

<strong>üìã ArrayList - Dynamic Size (Most Common!):</strong>
<pre>// Import first!
import java.util.ArrayList;

// Creating ArrayList (must specify type)
ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();
ArrayList&lt;String&gt; names = new ArrayList&lt;&gt;();

// Adding elements
list.add(1);                 // Add to end
list.add(0, 0);              // Insert at index 0
list.addAll(otherList);      // Add all from another list

// Accessing
int first = list.get(0);     // Get element at index 0
int size = list.size();      // Get size (method!)

// Modifying
list.set(0, 10);             // Change element at index 0
list.remove(0);              // Remove by index
list.remove(Integer.valueOf(10));  // Remove by value
list.clear();                // Remove all

// Checking
boolean has = list.contains(3);  // Check if exists
boolean empty = list.isEmpty();  // Check if empty
int index = list.indexOf(3);     // Find index (-1 if not found)

// Converting
Integer[] arr = list.toArray(new Integer[0]);  // To array
ArrayList&lt;Integer&gt; list2 = new ArrayList&lt;&gt;(Arrays.asList(1,2,3));  // From array</pre>

<strong>üìñ HashMap - Key-Value Pairs:</strong>
<pre>// Import first!
import java.util.HashMap;

// Creating HashMap
HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;();

// Adding/Updating
map.put("Alice", 25);        // Add or update
map.put("Bob", 30);

// Accessing
int age = map.get("Alice");  // 25
int def = map.getOrDefault("Charlie", 0);  // 0 (default)

// Checking & Removing
boolean has = map.containsKey("Alice");  // Check key exists
boolean hasVal = map.containsValue(25);  // Check value exists
map.remove("Bob");           // Remove key-value pair
int size = map.size();       // Get size

// Looping through HashMap
for (String key : map.keySet()) {
    System.out.println(key + ": " + map.get(key));
}

for (Map.Entry&lt;String, Integer&gt; entry : map.entrySet()) {
    System.out.println(entry.getKey() + ": " + entry.getValue());
}

// Get collections
Set&lt;String&gt; keys = map.keySet();      // All keys
Collection&lt;Integer&gt; values = map.values();  // All values</pre>

<strong>üéØ HashSet - Unique Values Only:</strong>
<pre>// Import first!
import java.util.HashSet;

// Creating HashSet (no duplicates!)
HashSet&lt;Integer&gt; set = new HashSet&lt;&gt;();
HashSet&lt;Integer&gt; set2 = new HashSet&lt;&gt;(Arrays.asList(1,2,3,3,3));  // {1,2,3}

// Operations
set.add(1);                  // Add element
set.add(1);                  // Duplicate ignored!
set.remove(1);               // Remove element
boolean has = set.contains(1);  // Check membership - O(1)
int size = set.size();       // Get size

// Loop through Set
for (int num : set) {
    System.out.println(num);
}</pre>

<strong>‚úÇÔ∏è Strings - Text Manipulation:</strong>
<pre>// Creating strings
String s = "Hello World";
String s2 = new String("Hello");

// Common operations
s.toUpperCase();             // "HELLO WORLD"
s.toLowerCase();             // "hello world"
s.trim();                    // Remove whitespace from ends
s.replace("World", "Java");  // "Hello Java"
String[] parts = s.split(" ");  // ["Hello", "World"]
String.join("-", parts);     // "Hello-World"

// String checks
s.startsWith("Hello");       // true
s.endsWith("d");             // true
s.contains("llo");           // true
boolean eq = s.equals("Hello World");  // Compare strings (NOT ==!)
boolean eqIgnore = s.equalsIgnoreCase("hello world");  // true

// Accessing characters
char c = s.charAt(0);        // 'H'
int len = s.length();        // 11 (method!)

// Substring
s.substring(0, 5);           // "Hello" (end not included)
s.substring(6);              // "World"

// Converting
String num = String.valueOf(123);  // "123"
int n = Integer.parseInt("123");   // 123
double d = Double.parseDouble("3.14");  // 3.14

// StringBuilder (for building strings efficiently)
StringBuilder sb = new StringBuilder();
sb.append("Hello");
sb.append(" ");
sb.append("World");
String result = sb.toString();  // "Hello World"</pre>

<strong>üî¢ Math & Numbers:</strong>
<pre>// Basic operators
+  -  *  /                   // Add, subtract, multiply, divide
%                            // Modulo: 7 % 2 = 1
++  --                       // Increment, decrement

// Math class
Math.abs(-5);                // 5
Math.min(1, 2);              // 1
Math.max(1, 2);              // 2
Math.floor(3.7);             // 3.0 (round down)
Math.ceil(3.2);              // 4.0 (round up)
Math.round(3.5);             // 4 (round nearest)
Math.pow(2, 3);              // 8.0 (2^3)
Math.sqrt(16);               // 4.0
Math.random();               // Random 0.0-1.0

// Integer division (watch out!)
int a = 7 / 2;               // 3 (not 3.5!)
double b = 7.0 / 2;          // 3.5

// Type casting
int x = (int) 3.7;           // 3
double y = (double) 5;       // 5.0</pre>

<strong>üõ†Ô∏è Methods (Functions):</strong>
<pre>// Method definition (must specify return type!)
public static int add(int a, int b) {
    return a + b;
}

// Void method (no return)
public static void greet(String name) {
    System.out.println("Hello, " + name);
}

// Method with default behavior (using overloading)
public static void greet() {
    greet("Guest");
}

public static void greet(String name) {
    System.out.println("Hello, " + name);
}

// Calling methods
int sum = add(5, 3);         // 8
greet("Alice");              // "Hello, Alice"
greet();                     // "Hello, Guest"</pre>

<strong>üí° Common Patterns for Coding Problems:</strong>
<pre>// Pattern 1: Two Pointers
int left = 0, right = arr.length - 1;
while (left &lt; right) {
    if (arr[left] + arr[right] == target) {
        return new int[]{left, right};
    } else if (arr[left] + arr[right] &lt; target) {
        left++;
    } else {
        right--;
    }
}

// Pattern 2: Frequency Counter
Map&lt;Integer, Integer&gt; freq = new HashMap&lt;&gt;();
for (int num : arr) {
    freq.put(num, freq.getOrDefault(num, 0) + 1);
}

// Pattern 3: Sliding Window
int windowSum = 0;
for (int i = 0; i &lt; arr.length; i++) {
    windowSum += arr[i];
    if (i >= windowSize) {
        windowSum -= arr[i - windowSize];
    }
}

// Pattern 4: Stack (LIFO)
Stack&lt;Integer&gt; stack = new Stack&lt;&gt;();
stack.push(item);            // Push
int top = stack.pop();       // Pop
int peek = stack.peek();     // Peek (don't remove)
boolean empty = stack.isEmpty();

// Pattern 5: Queue (FIFO)
Queue&lt;Integer&gt; queue = new LinkedList&lt;&gt;();
queue.offer(item);           // Enqueue (add)
int first = queue.poll();    // Dequeue (remove)
int peek = queue.peek();     // Peek
boolean empty = queue.isEmpty();

// Pattern 6: Priority Queue (Min Heap)
PriorityQueue&lt;Integer&gt; pq = new PriorityQueue&lt;&gt;();
pq.offer(item);              // Add
int min = pq.poll();         // Remove smallest

// Max Heap
PriorityQueue&lt;Integer&gt; maxPq = new PriorityQueue&lt;&gt;(Collections.reverseOrder());

// Pattern 7: Sorting with custom comparator
Collections.sort(list, (a, b) -> a - b);  // Ascending
Collections.sort(list, (a, b) -> b - a);  // Descending</pre>`
        };
        
        // Cheat sheet visibility state
        let cheatsheetVisible = true;
        
        // Lecture visibility state
        let lectureVisible = true;
        
        // Comprehensive lecture content for problem-solving methodology
        const LECTURE_CONTENT = `
            <h4>üß† How to Think Through Algorithm Problems (A Complete Beginner's Guide)</h4>
            <p>Welcome! This lecture will teach you <strong>how to think like a programmer</strong>. You don't need to memorize code‚Äîyou need to learn a systematic way to solve problems. By the end, you'll have a clear process to tackle ANY coding problem.</p>
            
            <h4>Why This Matters</h4>
            <p>Most beginners fail because they:</p>
            <ul>
                <li>‚ùå Jump straight to writing code without understanding the problem</li>
                <li>‚ùå Don't know WHERE to start or WHAT to think about</li>
                <li>‚ùå Get overwhelmed and give up</li>
            </ul>
            <p><strong>This lecture gives you a step-by-step roadmap</strong> so you always know what to do next.</p>
            
            <h4>1. The UMPIRE Method: Your 6-Step Problem-Solving Framework</h4>
            <p>Think of UMPIRE as a <strong>checklist</strong> you go through for every single problem. Each letter is a step:</p>
            <ul style="list-style: none; padding-left: 0;">
                <li>üìñ <strong>U</strong> = Understand the Problem</li>
                <li>üîç <strong>M</strong> = Match to a Pattern</li>
                <li>üìù <strong>P</strong> = Plan Your Approach</li>
                <li>‚å®Ô∏è <strong>I</strong> = Implement the Code</li>
                <li>‚úÖ <strong>R</strong> = Review and Test</li>
                <li>‚ö° <strong>E</strong> = Evaluate and Optimize</li>
            </ul>
            <p>Let's break down each step with real examples...</p>
            
            <h4>üìñ Step 1: UNDERSTAND the Problem (5 minutes minimum!)</h4>
            <p><strong>What this means:</strong> Read the problem carefully and figure out exactly what you're being asked to do BEFORE you write any code.</p>
            
            <h5>What to ask yourself:</h5>
            <ul>
                <li><strong>What are the inputs?</strong> (What data am I given?)</li>
                <li><strong>What is the output?</strong> (What should my function return?)</li>
                <li><strong>What are the edge cases?</strong> (What weird situations might happen?)</li>
                <li><strong>Are there constraints?</strong> (Size limits? Time limits? Special rules?)</li>
            </ul>
            
            <div class="example-box">
                <strong>üìò Real Example: "Two Sum" Problem</strong><br><br>
                <em>Problem Statement:</em> "Given an array of integers and a target number, return the indices of two numbers that add up to the target."<br><br>
                
                <strong>Let's UNDERSTAND it:</strong><br>
                ‚úÖ <strong>Input:</strong> An array like [2, 7, 11, 15] and a target like 9<br>
                ‚úÖ <strong>Output:</strong> Two indices (positions) like [0, 1] (because 2 + 7 = 9)<br>
                ‚úÖ <strong>Edge cases to think about:</strong><br>
                &nbsp;&nbsp;‚Ä¢ What if the array is empty?<br>
                &nbsp;&nbsp;‚Ä¢ What if there's no solution?<br>
                &nbsp;&nbsp;‚Ä¢ Can I use the same element twice? (e.g., [3, 3] target 6)<br>
                &nbsp;&nbsp;‚Ä¢ Are the numbers sorted? (Might affect our approach!)<br>
                ‚úÖ <strong>Constraints:</strong> Are there millions of numbers, or just a few? (Affects which solution is acceptable)
            </div>
            
            <div class="tip-box">
                <strong>üí° Pro Tip:</strong> Spend at least 5 minutes on this step! Most mistakes happen because people misunderstand the problem. Read it 2-3 times and restate it in your own words: "So I need to find two positions in the list where the values add up to the target..."
            </div>
            
            <h4>üîç Step 2: MATCH to a Pattern</h4>
            <p><strong>What this means:</strong> Most coding problems fall into common categories (patterns). Once you recognize the pattern, you know which tools (data structures) to use.</p>
            
            <h5>Common Patterns You'll See:</h5>
            
            <h5>üîπ Pattern 1: "Have I seen this before?" ‚Üí Use HASH MAP (Dictionary)</h5>
            <p><strong>When to use:</strong> The problem asks if something exists, or you need to count/track things.</p>
            <p><strong>Keywords:</strong> "find", "check if exists", "frequency", "seen before", "unique", "duplicate"</p>
            <p><strong>Examples:</strong> Two Sum, Contains Duplicate, First Non-Repeating Character</p>
            <p><strong>Why it works:</strong> Hash maps let you look things up INSTANTLY (O(1) time) instead of searching through a list every time.</p>
            
            <div class="example-box">
                <strong>Concrete Example:</strong><br>
                Problem: "Check if array has any duplicate values"<br><br>
                <strong>Without hash map (slow):</strong><br>
                For each number, loop through whole array to see if it appears again ‚Üí O(n¬≤) time!<br><br>
                <strong>With hash map (fast):</strong><br>
                Keep a set of seen numbers. For each new number, check "is it in my set?" If yes, it's a duplicate! ‚Üí O(n) time
            </div>
            
            <h5>üîπ Pattern 2: "Working with ranges/windows" ‚Üí Use SLIDING WINDOW</h5>
            <p><strong>When to use:</strong> Problem involves subarrays, substrings, or consecutive elements.</p>
            <p><strong>Keywords:</strong> "substring", "subarray", "consecutive", "window", "range"</p>
            <p><strong>Examples:</strong> Longest Substring Without Repeating Characters, Maximum Sum Subarray</p>
            <p><strong>Why it works:</strong> Instead of checking every possible range (slow), you maintain a "window" that slides across the data, only updating what changes.</p>
            
            <div class="example-box">
                <strong>Visual Example:</strong><br>
                Problem: "Find longest substring without repeating characters" in "abcabcbb"<br><br>
                Think of a window sliding across:<br>
                [abc]abcbb ‚Üí window size 3, no repeats ‚úì<br>
                a[bca]bcbb ‚Üí found 'a' again, shrink window from left<br>
                ab[cab]cbb ‚Üí shrink more...<br>
                abc[abc]bb ‚Üí found repeats, shrink...<br>
                The window "slides" and "shrinks" to avoid rechecking everything!
            </div>
            
            <h5>üîπ Pattern 3: "Comparing from both ends" ‚Üí Use TWO POINTERS</h5>
            <p><strong>When to use:</strong> Data is sorted, or you're checking for palindromes/pairs.</p>
            <p><strong>Keywords:</strong> "sorted", "palindrome", "pair", "two elements", "opposite ends"</p>
            <p><strong>Examples:</strong> Valid Palindrome, Two Sum II (sorted array), Remove Duplicates</p>
            <p><strong>Why it works:</strong> Start from both ends and move pointers toward each other, cutting the work in half.</p>
            
            <div class="example-box">
                <strong>Visual Example:</strong><br>
                Problem: "Check if string is palindrome" ‚Üí "racecar"<br><br>
                Use two pointers:<br>
                [r]aceca[r] ‚Üí match! move both inward<br>
                r[a]cec[a]r ‚Üí match! move inward<br>
                ra[c]e[c]ar ‚Üí match! move inward<br>
                rac[e]car ‚Üí middle letter, done! It's a palindrome!<br><br>
                Only checked 4 positions instead of all 7!
            </div>
            
            <h5>üîπ Pattern 4: "Matching pairs/nesting" ‚Üí Use STACK</h5>
            <p><strong>When to use:</strong> Problem involves matching, balancing, or nested structures.</p>
            <p><strong>Keywords:</strong> "valid", "balanced", "matching", "parentheses", "brackets", "nested"</p>
            <p><strong>Examples:</strong> Valid Parentheses, Balanced Brackets</p>
            <p><strong>Why it works:</strong> Stacks follow "Last In, First Out" (LIFO) - perfect for matching the most recent opening bracket with the next closing bracket.</p>
            
            <div class="example-box">
                <strong>Step-by-step Example:</strong><br>
                Problem: "Check if parentheses are balanced" ‚Üí "({[]})"<br><br>
                Using a stack (think of it like a stack of plates):<br>
                See '(' ‚Üí push onto stack: [(<br>
                See '{' ‚Üí push: [( {<br>
                See '[' ‚Üí push: [( { [<br>
                See ']' ‚Üí pop '[' (they match!) ‚Üí [( {<br>
                See '}' ‚Üí pop '{' (match!) ‚Üí [(<br>
                See ')' ‚Üí pop '(' (match!) ‚Üí []<br>
                Stack empty = balanced! ‚úì
            </div>
            
            <h5>üîπ Pattern 5: "Need top/best K items" ‚Üí Use HEAP (Priority Queue)</h5>
            <p><strong>When to use:</strong> Find K largest, K smallest, or K most frequent items.</p>
            <p><strong>Keywords:</strong> "top K", "largest", "smallest", "kth", "most frequent"</p>
            <p><strong>Examples:</strong> Kth Largest Element, Top K Frequent Elements</p>
            
            <div class="tip-box">
                <strong>üí° Pattern Recognition Tip:</strong> After solving 10-20 problems, you'll start seeing these patterns EVERYWHERE. It's like learning to recognize chords in music‚Äîonce you know them, you spot them instantly!
            </div>
            
            <h4>üìù Step 3: PLAN Your Approach</h4>
            <p><strong>What this means:</strong> Before typing code, write out your strategy in plain English (pseudocode).</p>
            
            <h5>How to plan (in order):</h5>
            <ol>
                <li><strong>Start with brute force:</strong> What's the OBVIOUS solution, even if it's slow?</li>
                <li><strong>Analyze complexity:</strong> Is it too slow? (O(n¬≤) might be okay for small data, not for millions of items)</li>
                <li><strong>Optimize:</strong> Can we use a better data structure? Trade space for speed?</li>
                <li><strong>Write pseudocode:</strong> Step-by-step plan in English, not code</li>
            </ol>
            
            <div class="example-box">
                <strong>üìò Planning Example: Two Sum Problem</strong><br><br>
                
                <strong>1. Brute Force (the obvious way):</strong><br>
                "Try every possible pair of numbers and check if they add to target"<br>
                ‚Üí Use two nested loops: for each number, check it against every other number<br>
                ‚Üí Time complexity: O(n¬≤) ‚Äî SLOW for large arrays!<br><br>
                
                <strong>2. Analyze:</strong><br>
                "O(n¬≤) means if array has 10,000 numbers, we do 100 million operations! Too slow!"<br><br>
                
                <strong>3. Optimize:</strong><br>
                "What if instead of searching for the partner number EVERY time, we remember what we've seen?"<br>
                ‚Üí Use a hash map! For each number X, check if (target - X) is in our map<br>
                ‚Üí Time complexity: O(n) ‚Äî WAY faster!<br><br>
                
                <strong>4. Pseudocode (step-by-step plan):</strong><br>
                <pre style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin-top: 8px;">
1. Create empty hash map
2. For each number at index i:
   a. Calculate complement = target - current number
   b. Check: is complement in hash map?
      - If YES: return [map[complement], i]
      - If NO: add current number to map with its index
3. If no pair found, return empty
                </pre>
            </div>
            
            <div class="warning-box">
                <strong>‚ö†Ô∏è Common Planning Mistake:</strong><br>
                Don't skip the pseudocode step! Writing out your plan in English BEFORE coding helps you catch logic errors early. It's like having a blueprint before building a house.
            </div>
            
            <h4>‚å®Ô∏è Step 4: IMPLEMENT the Code</h4>
            <p><strong>What this means:</strong> NOW you write actual code, translating your pseudocode line by line.</p>
            
            <h5>Best Practices While Coding:</h5>
            <ul>
                <li><strong>Use descriptive names:</strong> Not x, y, z ‚Üí use num, index, seen_numbers</li>
                <li><strong>Add comments:</strong> Explain the "why", not just the "what"</li>
                <li><strong>Handle edge cases:</strong> Check for empty input, null, single element</li>
                <li><strong>Type carefully:</strong> Watch out for off-by-one errors (is it i < n or i <= n?)</li>
            </ul>
            
            <div class="example-box">
                <strong>üìò Good vs Bad Code Example:</strong><br><br>
                
                <strong>‚ùå BAD (confusing, no comments):</strong><br>
                <pre style="background: #fee; padding: 12px; border-radius: 6px;">
def f(a, t):
    d = {}
    for i in range(len(a)):
        x = t - a[i]
        if x in d:
            return [d[x], i]
        d[a[i]] = i
                </pre>
                
                <strong>‚úÖ GOOD (clear, well-named, commented):</strong><br>
                <pre style="background: #efe; padding: 12px; border-radius: 6px;">
def two_sum(numbers, target):
    # Store numbers we've seen with their indices
    seen = {}
    
    for index, num in enumerate(numbers):
        complement = target - num
        
        # Check if we've seen the complement
        if complement in seen:
            return [seen[complement], index]
        
        # Remember this number for future lookups
        seen[num] = index
    
    return []  # No solution found
                </pre>
            </div>
            
            <h4>‚úÖ Step 5: REVIEW and Test</h4>
            <p><strong>What this means:</strong> Don't just hit "run" immediately! First, check your code manually.</p>
            
            <h5>Review Checklist:</h5>
            <ol>
                <li><strong>Desk check (walk through by hand):</strong> Pick a simple example and trace through your code line by line on paper</li>
                <li><strong>Check loop bounds:</strong> Does your loop go to the right index? (Common bug: using <= when you need <)</li>
                <li><strong>Verify all paths:</strong> Did you handle all if/else cases? Missing a return statement?</li>
                <li><strong>Test edge cases:</strong> Try empty input, single element, all same values, negative numbers</li>
            </ol>
            
            <div class="example-box">
                <strong>üìò Desk Check Example:</strong><br><br>
                Code: two_sum([2, 7, 11], 9)<br><br>
                <strong>Manual trace:</strong><br>
                Start: seen = {}<br><br>
                i=0, num=2, complement=7<br>
                ‚Üí Is 7 in seen? NO ‚Üí seen = {2: 0}<br><br>
                i=1, num=7, complement=2<br>
                ‚Üí Is 2 in seen? YES! ‚Üí return [0, 1] ‚úì<br><br>
                Result: [0, 1] (correct! 2+7=9)
            </div>
            
            <h4>‚ö° Step 6: EVALUATE and Optimize</h4>
            <p><strong>What this means:</strong> Even if your code works, ask: "Can I make it better?"</p>
            
            <h5>Big-O Complexity Quick Guide:</h5>
            <ul style="list-style: none; padding-left: 0;">
                <li><strong>O(1)</strong> ‚Äî Constant: Looking up array[5], hash map lookup ‚Üí FASTEST ‚ö°</li>
                <li><strong>O(log n)</strong> ‚Äî Logarithmic: Binary search, balanced tree ‚Üí VERY FAST</li>
                <li><strong>O(n)</strong> ‚Äî Linear: Single loop through array ‚Üí FAST (usually acceptable)</li>
                <li><strong>O(n log n)</strong> ‚Äî Linearithmic: Sorting (merge sort, quicksort) ‚Üí ACCEPTABLE</li>
                <li><strong>O(n¬≤)</strong> ‚Äî Quadratic: Nested loops ‚Üí SLOW (avoid for large data)</li>
                <li><strong>O(2‚Åø)</strong> ‚Äî Exponential: Recursive combinations ‚Üí VERY SLOW (rarely acceptable)</li>
            </ul>
            
            <div class="tip-box">
                <strong>üí° Quick Complexity Check:</strong><br>
                ‚Ä¢ One loop ‚Üí O(n)<br>
                ‚Ä¢ Two nested loops ‚Üí O(n¬≤)<br>
                ‚Ä¢ Halving each step (binary search) ‚Üí O(log n)<br>
                ‚Ä¢ Loop + sorting ‚Üí O(n log n)<br>
                ‚Ä¢ Hash map lookup/insert ‚Üí O(1)
            </div>
            
            <div class="example-box">
                <strong>Optimization Example:</strong><br><br>
                Problem: "Find if array contains duplicate"<br><br>
                <strong>Approach 1 (Brute Force):</strong><br>
                Compare each element with every other ‚Üí O(n¬≤) time, O(1) space<br><br>
                <strong>Approach 2 (Sorting):</strong><br>
                Sort array, then check adjacent elements ‚Üí O(n log n) time, O(1) space<br><br>
                <strong>Approach 3 (Hash Set) ‚Äî BEST:</strong><br>
                Add to set, check if already exists ‚Üí O(n) time, O(n) space<br><br>
                <em>Trade-off:</em> We use extra space (the set) to get faster time. Worth it!
            </div>
            
            <h4>üéØ Thinking Process: How to Build Logic from Scratch</h4>
            <p>When you see a new problem and don't know where to start, follow this mental process:</p>
            
            <h5>Step 1: Work Through Examples BY HAND (Don't Touch Code Yet!)</h5>
            <p>Before writing ANY code, solve 2-3 examples on paper exactly how YOU would do it manually.</p>
            
            <div class="example-box">
                <strong>Example: "Find Second Largest Number"</strong><br>
                Input: [5, 3, 9, 7, 3]<br><br>
                <strong>Your mental process:</strong><br>
                "Okay, I'm scanning left to right..."<br>
                ‚Ä¢ Start: 5 is largest so far (5), no second yet (-)<br>
                ‚Ä¢ See 3: smaller than 5, so 3 becomes second largest (5, 3)<br>
                ‚Ä¢ See 9: bigger than 5! Now 9 is largest, 5 becomes second (9, 5)<br>
                ‚Ä¢ See 7: less than 9, but more than 5! So 7 becomes second (9, 7)<br>
                ‚Ä¢ See 3: less than both, ignore<br>
                ‚Ä¢ Answer: 7<br><br>
                <strong>Pattern you discovered:</strong> Track TWO variables (largest and second_largest), update them as you scan!
            </div>
            
            <h5>Step 2: Ask Yourself These Questions</h5>
            <ul>
                <li><strong>"What am I tracking?"</strong> ‚Üí These become your variables<br>
                <em>Example: tracking largest and second_largest numbers</em></li>
                
                <li><strong>"What am I comparing?"</strong> ‚Üí These become your if/else conditions<br>
                <em>Example: comparing current number with largest, then with second_largest</em></li>
                
                <li><strong>"What am I repeating?"</strong> ‚Üí This becomes your loop<br>
                <em>Example: checking each number in the array</em></li>
                
                <li><strong>"When do I stop?"</strong> ‚Üí This is your loop condition or base case<br>
                <em>Example: when we've checked all numbers</em></li>
            </ul>
            
            <h5>Step 3: Break It Into Tiny Steps</h5>
            <p>Most algorithms follow this pattern:</p>
            <ol>
                <li><strong>Initialize:</strong> Set up variables (largest = first number, second = None)</li>
                <li><strong>Loop:</strong> Go through each element</li>
                <li><strong>Compare/Decide:</strong> Make decisions (is current > largest?)</li>
                <li><strong>Update:</strong> Change your tracking variables</li>
                <li><strong>Return:</strong> Give back the answer</li>
            </ol>
            
            <div class="tip-box">
                <strong>üí° The Secret:</strong> Most algorithm problems are just variations of:<br>
                "Loop through data ‚Üí make decisions ‚Üí track state ‚Üí return answer"<br><br>
                Once you see this pattern, coding becomes much easier!
            </div>
            
            <h4>üö´ Common Beginner Mistakes (and How to Avoid Them)</h4>
            
            <div class="warning-box">
                <strong>Mistake #1: Jumping straight to code</strong><br>
                ‚ùå Wrong: "I'll figure it out as I code!"<br>
                ‚úÖ Right: Spend 5+ minutes understanding and planning FIRST<br><br>
                
                <strong>Mistake #2: Not testing with simple examples</strong><br>
                ‚ùå Wrong: Write all the code, then test<br>
                ‚úÖ Right: Work through 2-3 examples by hand BEFORE coding<br><br>
                
                <strong>Mistake #3: Making it too complicated</strong><br>
                ‚ùå Wrong: Try to write the perfect optimized solution immediately<br>
                ‚úÖ Right: Start with brute force (simple but slow), THEN optimize<br><br>
                
                <strong>Mistake #4: Forgetting edge cases</strong><br>
                ‚ùå Wrong: Only test "happy path" (normal inputs)<br>
                ‚úÖ Right: Test empty input, single element, all same values, negatives<br><br>
                
                <strong>Mistake #5: Off-by-one errors</strong><br>
                ‚ùå Wrong: for i in range(len(arr)+1) ‚Üí index out of bounds!<br>
                ‚úÖ Right: for i in range(len(arr)) ‚Üí correct!<br>
                üí° <em>Tip: Arrays use 0-indexing, so length 5 ‚Üí indices 0,1,2,3,4</em>
            </div>
            
            <h4>üìà Practice Strategy: How to Get Better</h4>
            
            <h5>For Each Problem You Solve:</h5>
            <ol>
                <li><strong>‚úÖ Spend 5-10 minutes UNDERSTANDING before writing code</strong><br>
                Read problem 2-3 times, identify inputs/outputs, think about edge cases</li>
                
                <li><strong>‚úÖ Work through 2-3 examples BY HAND on paper</strong><br>
                Pretend you're the computer‚Äîwhat steps would you take?</li>
                
                <li><strong>‚úÖ Write pseudocode FIRST (English, not code)</strong><br>
                Plan your approach step-by-step before touching the keyboard</li>
                
                <li><strong>‚úÖ Code carefully with good names and comments</strong><br>
                Make it readable‚Äîyou'll thank yourself when debugging!</li>
                
                <li><strong>‚úÖ Test edge cases IMMEDIATELY (don't wait!)</strong><br>
                Try empty input, single element, duplicates, large numbers, negatives</li>
                
                <li><strong>‚úÖ Review even if it passes‚Äîcan you improve it?</strong><br>
                Better complexity? Cleaner code? Different approach?</li>
            </ol>
            
            <div class="tip-box">
                <strong>üí° The 5-3-1 Practice Rule:</strong><br>
                ‚Ä¢ First 5 problems: Slow and methodical, focus on understanding the process<br>
                ‚Ä¢ Next 3 problems: Start recognizing patterns, get a bit faster<br>
                ‚Ä¢ After 1 week: You'll notice you're thinking in patterns automatically!<br><br>
                <em>Progress isn't linear‚Äîyou might feel stuck, then suddenly everything clicks!</em>
            </div>
            
            <h4>üß† Building Intuition: The Long Game</h4>
            <p><strong>Important:</strong> You're not born with problem-solving skills‚Äîthey're built through practice. Here's how intuition develops:</p>
            
            <h5>Phase 1: Confusion (Problems 1-10)</h5>
            <ul>
                <li>‚ùì "I have no idea what to do!"</li>
                <li>üêå Everything feels slow and difficult</li>
                <li>üìö Need to look at solutions frequently</li>
                <li>‚úÖ <strong>This is NORMAL!</strong> Everyone starts here. Keep going!</li>
            </ul>
            
            <h5>Phase 2: Recognition (Problems 10-30)</h5>
            <ul>
                <li>üí° "Wait, this looks like that other problem..."</li>
                <li>üîç Starting to see patterns emerge</li>
                <li>‚ö° Some problems feel easier than before</li>
                <li>‚úÖ <strong>Progress!</strong> Your brain is building connections!</li>
            </ul>
            
            <h5>Phase 3: Confidence (Problems 30+)</h5>
            <ul>
                <li>üéØ "Ah, this is a two-pointer problem!"</li>
                <li>üöÄ Can solve many problems independently</li>
                <li>üß© See multiple solution approaches</li>
                <li>‚úÖ <strong>You've got this!</strong> Keep practicing to maintain and deepen skills!</li>
            </ul>
            
            <div class="example-box">
                <strong>Real Student Example:</strong><br><br>
                <em>"After problem 1-5, I felt hopeless. Everything was confusing. But I kept using the UMPIRE method every time. Around problem 15, something clicked‚ÄîI saw a 'hash map' problem and immediately knew what to do WITHOUT hints! Now (problem 40+), I can solve most medium problems in 20-30 minutes. The secret? Consistency and following the framework EVERY time."</em>
                <br><br>‚Äî Alex, Software Engineer Intern at Microsoft
            </div>
            
            <h4>üéì When You're Stuck on a Problem</h4>
            <p>Being stuck is PART OF LEARNING. Here's your unsticking checklist:</p>
            
            <h5>Level 1: Re-read and Restate</h5>
            <ul>
                <li>‚òëÔ∏è Read the problem again slowly</li>
                <li>‚òëÔ∏è Restate it in your own words out loud</li>
                <li>‚òëÔ∏è Work through the example given step-by-step</li>
            </ul>
            
            <h5>Level 2: Try a Simple Example</h5>
            <ul>
                <li>‚òëÔ∏è Make up a TINY example (array with 3 elements)</li>
                <li>‚òëÔ∏è Solve it BY HAND on paper</li>
                <li>‚òëÔ∏è Notice what steps YOU took‚Äîthat's your algorithm!</li>
            </ul>
            
            <h5>Level 3: Ask Pattern Questions</h5>
            <ul>
                <li>‚òëÔ∏è "Do I need to remember things?" ‚Üí Hash map/set</li>
                <li>‚òëÔ∏è "Am I working with ranges?" ‚Üí Sliding window</li>
                <li>‚òëÔ∏è "Is data sorted?" ‚Üí Two pointers / binary search</li>
                <li>‚òëÔ∏è "Am I matching pairs?" ‚Üí Stack</li>
            </ul>
            
            <h5>Level 4: Use Hints (No Shame!)</h5>
            <ul>
                <li>‚òëÔ∏è Look at Hint 1 only‚Äîtry again</li>
                <li>‚òëÔ∏è Still stuck? Hint 2‚Äîtry again</li>
                <li>‚òëÔ∏è Read pseudocode and understand WHY it works</li>
                <li>‚òëÔ∏è Try to code it yourself BEFORE copying</li>
            </ul>
            
            <h5>Level 5: Look at Solution (Learning Tool)</h5>
            <ul>
                <li>‚òëÔ∏è Read the solution slowly</li>
                <li>‚òëÔ∏è Understand EVERY line‚Äîdon't just copy!</li>
                <li>‚òëÔ∏è Close the solution and try to recreate from memory</li>
                <li>‚òëÔ∏è Come back tomorrow and solve again WITHOUT looking!</li>
            </ul>
            
            <div class="warning-box">
                <strong>‚ö†Ô∏è Using Hints Effectively:</strong><br>
                ‚ùå Don't: Look at full solution immediately ‚Üí you learn nothing<br>
                ‚úÖ Do: Struggle for 15-20 mins, then use hints incrementally<br>
                ‚úÖ Do: After seeing solution, solve again from scratch later<br><br>
                <em>Struggling is WHERE learning happens! Embrace the difficulty!</em>
            </div>
            
            <h4>üìö Quick Reference: Your Problem-Solving Checklist</h4>
            <p>Print this out and keep it next to your computer!</p>
            
            <div class="tip-box" style="background: #f0f9ff; border-color: #3b82f6;">
                <strong>üéØ The Ultimate Checklist (Use EVERY Time!):</strong><br><br>
                
                <strong>Before Coding:</strong><br>
                ‚ñ° Read problem 2-3 times<br>
                ‚ñ° Identify inputs, outputs, edge cases<br>
                ‚ñ° Work through 2 examples by hand<br>
                ‚ñ° Recognize the pattern (hash map? two pointers? etc.)<br>
                ‚ñ° Write pseudocode in plain English<br><br>
                
                <strong>While Coding:</strong><br>
                ‚ñ° Use descriptive variable names<br>
                ‚ñ° Add comments explaining the why<br>
                ‚ñ° Handle edge cases (empty, single element)<br>
                ‚ñ° Check array bounds carefully<br><br>
                
                <strong>After Coding:</strong><br>
                ‚ñ° Desk check with simple example<br>
                ‚ñ° Test edge cases (empty, duplicates, negatives)<br>
                ‚ñ° Verify loop bounds (off-by-one?)<br>
                ‚ñ° Calculate time/space complexity<br>
                ‚ñ° Ask: "Can I make this better?"<br>
            </div>
            
            <h4>üí™ Final Words of Encouragement</h4>
            
            <p style="margin-top: 20px; padding: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
                <strong>üåü Remember This:</strong><br><br>
                
                Every expert programmer you admire was once exactly where you are now‚Äîconfused, stuck, frustrated. The ONLY difference between them and you is <strong>time + practice + persistence</strong>.<br><br>
                
                ‚Ä¢ It's OKAY to struggle‚Äîthat's your brain forming new connections!<br>
                ‚Ä¢ It's OKAY to use hints‚Äîthat's how you learn!<br>
                ‚Ä¢ It's OKAY to take breaks‚Äîyour brain processes while you rest!<br>
                ‚Ä¢ It's OKAY to solve the same problem multiple times‚Äîrepetition builds mastery!<br><br>
                
                <strong>The UMPIRE method is your compass.</strong> When lost, go back to step 1: Understand. When stuck, revisit your Plan. When debugging, Review carefully.<br><br>
                
                <strong>You've got this! üöÄ</strong>
            </p>
            
            <p style="margin-top: 16px; padding: 12px; background: #f0fdf4; border-radius: 6px; border-left: 4px solid #22c55e;">
                <strong>Next Steps:</strong> Pick a problem from the sidebar ‚Üí Use the Notepad to apply UMPIRE ‚Üí Code your solution ‚Üí Review with the debugger. You're building a skill that will serve you for your entire career. Start small, stay consistent, and watch yourself improve! ÔøΩ‚ú®
            </p>
        `;
        
        // Set initial language selector value
        document.addEventListener('DOMContentLoaded', () => {
            const langSelect = document.getElementById('language-select');
            langSelect.value = currentLanguage;
            
            langSelect.addEventListener('change', (e) => {
                currentLanguage = e.target.value;
                localStorage.setItem('selectedLanguage', currentLanguage);
                
                // Reload current problem with new language
                if (currentProblem) {
                    loadProblem(currentProblem.name);
                }
                
                // Update editor placeholder
                updateEditorPlaceholder();
                
                // Update debugger visibility
                updateDebuggerVisibility();

                // Update syntax docs for new language
                renderSyntaxDocs(currentLanguage);
            });
        });
        
        function updateEditorPlaceholder() {
            const editor = document.getElementById('code-editor');
            const placeholders = {
                python: '# Write your Python solution here...',
                javascript: '// Write your JavaScript solution here...',
                java: '// Write your Java solution here...',
                cpp: '// Write your C++ solution here...'
            };
            editor.placeholder = placeholders[currentLanguage] || '// Write your solution here...';
        }
        
        function updateDebuggerVisibility() {
            const debugSection = document.getElementById('debug-section');
            const debugHeader = debugSection.querySelector('.debug-header');
            const debugBody = document.getElementById('debug-body');
            const toggleBtn = document.getElementById('toggle-debug');
            
            if (currentLanguage !== 'python') {
                // Hide debugger for non-Python languages
                debugBody.classList.add('hidden');
                toggleBtn.disabled = true;
                toggleBtn.style.opacity = '0.5';
                toggleBtn.style.cursor = 'not-allowed';
                toggleBtn.textContent = 'Debugger (Python only)';
                toggleBtn.title = 'The step debugger is only available for Python';
            } else {
                // Show debugger for Python
                toggleBtn.disabled = false;
                toggleBtn.style.opacity = '1';
                toggleBtn.style.cursor = 'pointer';
                toggleBtn.textContent = debugBody.classList.contains('hidden') ? 'Show debugger' : 'Hide debugger';
                toggleBtn.title = '';
            }
        }
        
        // Load problems on page load
        async function loadProblems() {
            try {
                const response = await fetch('/api/problems');
                const problems = await response.json();
                
                const listEl = document.getElementById('problem-list');
                listEl.innerHTML = '';
                
                problems.forEach(problem => {
                    const li = document.createElement('li');
                    li.className = 'problem-item';
                    const difficulty = getDifficulty(problem.name);
                    const badge = `<span class="difficulty-badge difficulty-${difficulty}">${difficulty}</span>`;
                    li.innerHTML = `<div class="problem-title">${problem.title}${badge}</div>`;
                    // Pass the element itself to avoid relying on event.target
                    li.onclick = () => loadProblem(problem.name, li);
                    listEl.appendChild(li);
                });
                // Auto-select the first problem for better UX
                if (problems.length > 0 && listEl.firstChild) {
                    loadProblem(problems[0].name, listEl.firstChild);
                }
            } catch (error) {
                console.error('Failed to load problems:', error);
                document.getElementById('problem-list').innerHTML = '<li>Error loading problems</li>';
            }
        }
        
        // Load specific problem
        async function loadProblem(name, el) {
            try {
                const response = await fetch(`/api/problem/${name}?language=${currentLanguage}`);
                if (!response.ok) {
                    throw new Error(`Failed to load problem: ${response.statusText}`);
                }
                const problem = await response.json();
                
                // Validate problem structure
                if (!problem.tests || !Array.isArray(problem.tests)) {
                    console.error('Invalid problem structure:', problem);
                    throw new Error('Problem data is missing tests array');
                }
                
                currentProblem = problem;
                originalStub = problem.stub;
                
                // Update active state in sidebar
                document.querySelectorAll('.problem-item').forEach(item => {
                    item.classList.remove('active');
                });
                if (el) {
                    el.classList.add('active');
                }
                
                // Show problem view
                document.getElementById('welcome-message').classList.add('hidden');
                document.getElementById('problem-view').classList.remove('hidden');
                
                // Update content
                console.log('Loading problem:', problem);
                document.getElementById('problem-title-text').textContent = problem.title;
                document.getElementById('problem-description').textContent = problem.description;
                
                // Show test cases
                const testCasesEl = document.getElementById('test-cases');
                testCasesEl.innerHTML = problem.tests.map((test, i) => 
                    `<div>Test ${i+1}: ${test.args} ‚Üí ${test.expected}</div>`
                ).join('');
                document.getElementById('test-cases-section').classList.remove('hidden');
                
                // Load code
                document.getElementById('code-editor').value = problem.stub;
                editorBps.clear();
                refreshEditorUI();
                // Reset debug breakpoints input
                const bpsInput = document.getElementById('debug-bps');
                if (bpsInput) bpsInput.value = '';
                
                // Populate debug test selector
                const debugSel = document.getElementById('debug-test');
                debugSel.innerHTML = problem.tests.map((t, i) => `<option value="${i}">Test ${i+1}: ${t.args}</option>`).join('') || '<option value="0">(no tests)</option>';

                // Load hints
                currentHints = problem.hints || null;
                const hintsSection = document.getElementById('hints-section');
                const hintsBody = document.getElementById('hints-body');
                const bulletsEl = document.getElementById('hints-bullets');
                const pseudoEl = document.getElementById('hints-pseudocode');
                if (currentHints) {
                    hintsSection.classList.remove('hidden');
                    // Restore hint visibility state from memory
                    const wasVisible = hintVisibilityState[problem.name];
                    if (wasVisible) {
                        hintsBody.classList.remove('hidden');
                        document.getElementById('toggle-hints').textContent = 'Hide hints';
                    } else {
                        hintsBody.classList.add('hidden');
                        document.getElementById('toggle-hints').textContent = 'Show hints';
                    }
                    // Render bullets
                    const bullets = (currentHints.bullets || []).map(b => `<li>${b}</li>`).join('');
                    bulletsEl.innerHTML = bullets || '<li>No hints available.</li>';
                    // Render pseudocode - replace escaped newlines with actual newlines
                    const pseudocode = (currentHints.pseudocode || '').trim().replace(/\\n/g, '\n');
                    pseudoEl.textContent = pseudocode;
                } else {
                    hintsSection.classList.add('hidden');
                }

                // Load glossary (fetch once, then filter per problem)
                await ensureGlossary();
                renderGlossary(problem.terms || []);

                // Update debugger visibility based on language
                updateDebuggerVisibility();

                // Render language syntax docs for the selected language
                renderSyntaxDocs(currentLanguage);
                
                // Render cheat sheet for current language
                renderCheatSheet(currentLanguage);
                
                // Load lecture content
                loadLecture();

                // Load notepad content for this problem (preserve visibility state)
                loadNotepadContent();
                document.getElementById('notepad-section').classList.remove('hidden');
                const notepadBody = document.getElementById('notepad-body');
                const notepadBtn = document.getElementById('toggle-notepad');
                if (notepadVisible) {
                    notepadBody.classList.remove('hidden');
                    notepadBtn.textContent = 'Hide notepad';
                } else {
                    notepadBody.classList.add('hidden');
                    notepadBtn.textContent = 'Show notepad';
                }

                // Reset and start timer
                resetTimer();
                startTimer();

                // Hide results
                document.getElementById('results-section').classList.add('hidden');
            } catch (error) {
                console.error('Failed to load problem:', error);
                alert('Error loading problem: ' + error.message);
            }
        }

        // Inject syntax docs section markup into the right column under hints
        document.addEventListener('DOMContentLoaded', () => {
            // Inject syntax docs under hints or at end of problem view
            const container = document.getElementById('problem-view') || document.querySelector('.workspace') || document.body;
            if (!document.getElementById('syntax-section')) {
                const section = document.createElement('section');
                section.id = 'syntax-section';
                section.className = 'syntax-section';
                section.innerHTML = `
                    <div class="syntax-header">
                        <h3 style="margin:0;">Language syntax</h3>
                        <button id="toggle-syntax" class="syntax-toggle" type="button">Show</button>
                    </div>
                    <div id="syntax-body" class="syntax-body hidden">
                        <div id="syntax-content"></div>
                    </div>
                `;
                const hints = document.getElementById('hints-section');
                if (hints && hints.parentNode) {
                    hints.parentNode.insertBefore(section, hints.nextSibling);
                } else {
                    container.appendChild(section);
                }

                // Toggle wiring
                const toggleBtn = section.querySelector('#toggle-syntax');
                const body = section.querySelector('#syntax-body');
                toggleBtn.addEventListener('click', () => {
                    const isHidden = body.classList.toggle('hidden');
                    toggleBtn.textContent = isHidden ? 'Show' : 'Hide';
                });

                // Render initial docs
                renderSyntaxDocs(currentLanguage);
            }
        });
        
                // Language Syntax Docs
                const LANG_SYNTAX = {
                        'python': `
<pre><code># Function
def foo(a, b=0):
        return a + b

# Print
print("hello")

# Lists / Dicts
nums = [1, 2, 3]
mp = {"a": 1, "b": 2}

# Loop
for x in nums:
        print(x)

# If
if a > b:
        ...
else:
        ...</code></pre>`,
                        'javascript': `
<pre><code>// Function
function foo(a, b = 0) {
    return a + b;
}

// Print
console.log("hello");

// Arrays / Objects
const nums = [1, 2, 3];
const mp = { a: 1, b: 2 };

// Loop
for (const x of nums) {
    console.log(x);
}

// If
if (a > b) {
    // ...
} else {
    // ...
}</code></pre>`,
                        'java': `
<pre><code>// Method in class Solution
public class Solution {
    public int foo(int a, int b) {
        return a + b;
    }
}

// Print
System.out.println("hello");

// Arrays / Map
int[] nums = new int[]{1,2,3};
Map<String,Integer> mp = new HashMap<>();
mp.put("a", 1);

// Loop
for (int x : nums) {
    System.out.println(x);
}

// If
if (a > b) {
    // ...
} else {
    // ...
}</code></pre>`,
                        'cpp': `
<pre><code>// Function
int foo(int a, int b) {
    return a + b;
}

// Print
#include <iostream>
std::cout << "hello" << std::endl;

// Vector / Unordered Map
#include <vector>
#include <unordered_map>
std::vector<int> nums{1,2,3};
std::unordered_map<std::string,int> mp{{"a",1},{"b",2}};

// Loop
for (int x : nums) {
    std::cout << x << std::endl;
}

// If
if (a > b) {
    // ...
} else {
    // ...
}</code></pre>`
                };

        function renderSyntaxDocs(lang) {
            const section = document.getElementById('syntax-section');
            const content = document.getElementById('syntax-content');
            if (!section || !content) return; // Section not present yet
            const doc = LANG_SYNTAX[lang];
            if (doc) {
                section.classList.remove('hidden');
                content.innerHTML = doc;
            } else {
                section.classList.add('hidden');
                content.innerHTML = '';
            }
        }
        
        // Submit solution
        async function submitSolution() {
            if (!currentProblem) {
                alert('Please select a problem first');
                return;
            }
            
            const code = document.getElementById('code-editor').value;
            const submitBtn = document.getElementById('submit-btn');
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Running...';
            
            try {
                const response = await fetch('/api/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        problem: currentProblem.name,
                        code: code,
                        language: currentLanguage
                    })
                });
                
                const result = await response.json();
                displayResults(result);
            } catch (error) {
                console.error('Submission error:', error);
                alert('Error submitting solution');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Run Tests';
            }
        }
        
        // Display results
        function displayResults(result) {
            const resultsSection = document.getElementById('results-section');
            const summaryEl = document.getElementById('results-summary');
            const testResultsEl = document.getElementById('test-results');
            
            resultsSection.classList.remove('hidden');
            
            if (result.error) {
                summaryEl.className = 'results-summary failed';
                summaryEl.textContent = `‚ùå Error`;
                testResultsEl.innerHTML = `<div class="error-box">${result.error}</div>`;
                return;
            }
            
            const allPassed = result.passed === result.total;
            summaryEl.className = `results-summary ${allPassed ? 'passed' : 'failed'}`;
            summaryEl.textContent = `${allPassed ? '‚úÖ' : '‚ùå'} ${result.passed}/${result.total} tests passed`;
            
            // Save time session when tests are run
            if (currentProblem && timerSeconds > 0) {
                saveTimeSession(currentProblem.name, timerSeconds, allPassed);
            }
            
            testResultsEl.innerHTML = result.results.map(test => {
                const status = test.passed ? 'pass' : 'fail';
                const icon = test.passed ? '‚úÖ' : '‚ùå';
                
                let html = `
                    <div class="test-result ${status}">
                        <div class="test-result-header">${icon} Test ${test.test_num}</div>
                        <div class="test-detail">Input: ${test.args}</div>
                        <div class="test-detail">Expected: ${test.expected}</div>
                        <div class="test-detail">Actual: ${test.actual || 'N/A'}</div>
                `;
                
                if (test.error) {
                    html += `<div class="test-detail" style="color: #dc3545;">Error: ${test.error}</div>`;
                }
                
                html += `</div>`;
                return html;
            }).join('');
        }
        
        // Reset code
        function resetCode() {
            if (confirm('Reset code to original stub?')) {
                document.getElementById('code-editor').value = originalStub;
                document.getElementById('results-section').classList.add('hidden');
            }
        }
        
        // Event listeners
        document.getElementById('submit-btn').onclick = submitSolution;
        document.getElementById('reset-btn').onclick = resetCode;
        document.getElementById('toggle-hints').onclick = () => {
            const body = document.getElementById('hints-body');
            const btn = document.getElementById('toggle-hints');
            const hidden = body.classList.contains('hidden');
            if (hidden) {
                body.classList.remove('hidden');
                btn.textContent = 'Hide hints';
                if (currentProblem) {
                    hintVisibilityState[currentProblem.name] = true;
                }
            } else {
                body.classList.add('hidden');
                btn.textContent = 'Show hints';
                if (currentProblem) {
                    hintVisibilityState[currentProblem.name] = false;
                }
            }
        };

        // Debugger toggle
        document.getElementById('toggle-debug').onclick = () => {
            const body = document.getElementById('debug-body');
            const btn = document.getElementById('toggle-debug');
            const hidden = body.classList.contains('hidden');
            if (hidden) { body.classList.remove('hidden'); btn.textContent = 'Hide debugger'; }
            else { body.classList.add('hidden'); btn.textContent = 'Show debugger'; }
        };

        // Run debug
        document.getElementById('debug-run').onclick = runDebug;
        // Keep gutter and input in sync when user types breakpoints
        const debugBpsEl = document.getElementById('debug-bps');
        if (debugBpsEl) {
            debugBpsEl.addEventListener('change', syncEditorBpsFromInput);
        }

        async function runDebug() {
            if (!currentProblem) { alert('Select a problem first'); return; }
            const code = document.getElementById('code-editor').value;
            const testIndex = parseInt(document.getElementById('debug-test').value || '0', 10) || 0;
            const custom = document.getElementById('debug-custom').value.trim();
            const typedBps = (document.getElementById('debug-bps').value || '')
                .split(',').map(x => parseInt(x.trim(), 10)).filter(x => !isNaN(x));
            // Merge typed + gutter breakpoints (dedupe)
            const merged = new Set([...(typedBps || []), ...editorBps]);
            const bps = Array.from(merged).sort((a,b)=>a-b);

            const payload = { problem: currentProblem.name, code, testIndex, breakpoints: bps, maxSteps: 500 };
            if (custom) { payload.customArgsJson = custom; }

            const meta = document.getElementById('debug-meta');
            meta.textContent = 'Running‚Ä¶';
            try {
                const res = await fetch('/api/debug', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                const dbg = await res.json();
                if (!res.ok || dbg.error) {
                    renderDebugError(dbg.error || `HTTP ${res.status}`);
                    meta.textContent = '';
                    return;
                }
                debugTrace = dbg.trace || [];
                debugIndex = 0;
                renderDebugOutput(dbg);
                meta.textContent = (dbg.truncated ? 'Trace truncated. ' : '') + `Steps: ${debugTrace.length}`;
            } catch (e) {
                renderDebugError('Failed to run debug: ' + e.message);
                meta.textContent = '';
            }
        }

        function renderDebugError(msg) {
            document.getElementById('debug-output').innerHTML = `<div class="error-box">${msg}</div>`;
        }

        function renderDebugOutput(dbg) {
            const out = document.getElementById('debug-output');
            if (!debugTrace.length) { out.innerHTML = '<div>No trace captured.</div>'; return; }

            const nav = `
                <div class="trace-nav">
                    <button class="btn-small" onclick="window.__dbgPrev()">‚óÄ Prev</button>
                    <div>Step <span id="dbg-step">${debugIndex+1}</span>/<span id="dbg-total">${debugTrace.length}</span></div>
                    <button class="btn-small" onclick="window.__dbgNext()">Next ‚ñ∂</button>
                </div>`;

            const step = debugTrace[debugIndex];
            const localsHtml = Object.entries(step.locals || {}).map(([k,v]) =>
                `<div class="locals-key">${k}</div><div class="locals-val">${v}</div>`
            ).join('') || '<div>(no locals)</div>';

            out.innerHTML = `
                ${nav}
                <div class="trace-step">
                    <div class="trace-line"><strong>${step.event.toUpperCase()}</strong> line ${step.line}: <code>${escapeHtml(step.code || '')}</code></div>
                    ${step.return ? `<div class="test-detail">Return: ${escapeHtml(String(step.return))}</div>` : ''}
                    <div class="test-detail"><strong>Locals:</strong></div>
                    <div class="locals-grid">${localsHtml}</div>
                </div>
                <div class="test-detail"><strong>Args used:</strong> ${escapeHtml(String(dbg.argsUsed || ''))}</div>
                ${dbg.stdout ? `<div class="test-detail"><strong>Stdout:</strong> <pre>${escapeHtml(dbg.stdout)}</pre></div>` : ''}
                ${dbg.stderr ? `<div class="test-detail" style="color:#dc3545;"><strong>Stderr:</strong> <pre>${escapeHtml(dbg.stderr)}</pre></div>` : ''}
                ${nav}
            `;

            // Expose navigation
            window.__dbgPrev = () => { if (debugIndex > 0) { debugIndex--; renderDebugOutput(dbg); } };
            window.__dbgNext = () => { if (debugIndex < debugTrace.length-1) { debugIndex++; renderDebugOutput(dbg); } };
        }

        function escapeHtml(s) {
            return (s || '').replace(/[&<>]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c]));
        }

        // Glossary toggle
        document.getElementById('toggle-glossary').onclick = () => {
            const body = document.getElementById('glossary-body');
            const btn = document.getElementById('toggle-glossary');
            const hidden = body.classList.contains('hidden');
            if (hidden) {
                body.classList.remove('hidden');
                btn.textContent = 'Hide glossary';
                glossaryVisibleState = true;
            } else {
                body.classList.add('hidden');
                btn.textContent = 'Show glossary';
                glossaryVisibleState = false;
            }
        };

        // AI Assistant toggle
        document.getElementById('toggle-ai').onclick = () => {
            const body = document.getElementById('ai-body');
            const btn = document.getElementById('toggle-ai');
            const hidden = body.classList.contains('hidden');
            if (hidden) { body.classList.remove('hidden'); btn.textContent = 'Hide assistant'; }
            else { body.classList.add('hidden'); btn.textContent = 'Show assistant'; }
        };

        // Time Stats toggle
        document.getElementById('toggle-time-stats').onclick = () => {
            const body = document.getElementById('time-stats-body');
            const btn = document.getElementById('toggle-time-stats');
            const hidden = body.classList.contains('hidden');
            if (hidden) { 
                body.classList.remove('hidden'); 
                btn.textContent = 'Hide stats'; 
            } else { 
                body.classList.add('hidden'); 
                btn.textContent = 'Show stats'; 
            }
        };

        // Timer controls
        document.getElementById('timer-pause').onclick = pauseTimer;
        document.getElementById('timer-reset').onclick = resetTimer;
        
        // Clear time history
        document.getElementById('clear-stats-btn').onclick = clearTimeHistory;

        // Ask AI
        document.getElementById('ai-ask').onclick = askAI;
        
        // Notepad event listeners
        document.getElementById('toggle-notepad').onclick = toggleNotepad;
        document.getElementById('load-template').onclick = loadTemplate;
        document.getElementById('clear-notepad').onclick = clearNotepad;
        
        // Auto-save notepad content as user types
        document.getElementById('notepad-textarea').addEventListener('input', saveNotepadContent);
        
        // Cheat sheet toggle
        document.getElementById('toggle-cheatsheet').onclick = toggleCheatSheet;
        
        // Lecture toggle
        document.getElementById('toggle-lecture').onclick = toggleLecture;

        // Check AI status on load
        (async function checkAIStatus(){
            const meta = document.getElementById('ai-meta');
            try {
                const res = await fetch('/api/ask/status');
                const s = await res.json();
                if (!s.enabled) {
                    meta.textContent = 'AI disabled: ' + (s.message || 'missing key');
                    document.getElementById('ai-ask').disabled = true;
                    document.getElementById('ai-ask').title = 'AI disabled: set OPENAI_API_KEY in .env and restart server';
                } else {
                    meta.textContent = '';
                    document.getElementById('ai-ask').disabled = false;
                }
            } catch (e) {
                meta.textContent = 'AI status unknown';
            }
        })();

        async function askAI() {
            const prompt = (document.getElementById('ai-prompt').value || '').trim();
            if (!prompt) { alert('Please enter a question'); return; }
            const includeDescription = document.getElementById('ai-inc-desc').checked;
            const includeCode = document.getElementById('ai-inc-code').checked;
            const includeTests = document.getElementById('ai-inc-tests').checked;
            const includeHints = document.getElementById('ai-inc-hints').checked;
            const meta = document.getElementById('ai-meta');
            const out = document.getElementById('ai-output');

            const payload = {
                prompt,
                problem: currentProblem ? currentProblem.name : null,
                language: currentLanguage,
                includeDescription,
                includeCode,
                includeHints,
                includeTests,
                code: includeCode ? (document.getElementById('code-editor').value || '') : ''
            };

            out.innerHTML = '';
            meta.textContent = 'Thinking‚Ä¶';
            try {
                const res = await fetch('/api/ask', {
                    method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload)
                });
                const ans = await res.json();
                if (!res.ok || ans.error) {
                    out.innerHTML = `<div class="error-box">${escapeHtml(ans.error || `HTTP ${res.status}`)}</div>`;
                    meta.textContent = '';
                    return;
                }
                renderAIAnswer(ans.answer || '');
                meta.textContent = '';
            } catch (e) {
                out.innerHTML = `<div class="error-box">${escapeHtml('Failed to reach AI: ' + e.message)}</div>`;
                meta.textContent = '';
            }
        }

        function renderAIAnswer(text) {
            const out = document.getElementById('ai-output');
            const safe = escapeHtml(text);
            // very light markdown: code fences ‚Üí pre blocks
            const html = safe
                .replace(/```([\s\S]*?)```/g, (m, p1) => `<pre><code>${p1}</code></pre>`)
                .replace(/\n\n/g, '\n');
            out.innerHTML = `
                <div class="ai-actions">
                    <button class="btn-copy" onclick="copyText('${encodeURIComponent(text)}', this)">Copy answer</button>
                </div>
                <div class="ai-answer">${html}</div>
            `;
        }
        
        // Copy pseudocode to clipboard
        document.getElementById('copy-pseudo-btn').onclick = async () => {
            const pseudoEl = document.getElementById('hints-pseudocode');
            const btn = document.getElementById('copy-pseudo-btn');
            const originalText = btn.textContent;
            
            try {
                await navigator.clipboard.writeText(pseudoEl.textContent);
                btn.textContent = '‚úì Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.classList.remove('copied');
                }, 2000);
            } catch (err) {
                console.error('Failed to copy:', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = pseudoEl.textContent;
                textArea.style.position = 'fixed';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    btn.textContent = '‚úì Copied!';
                    btn.classList.add('copied');
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.classList.remove('copied');
                    }, 2000);
                } catch (e) {
                    alert('Failed to copy to clipboard');
                } finally {
                    document.body.removeChild(textArea);
                }
            }
        };
        
        // Allow Tab in textarea
        document.getElementById('code-editor').addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                const start = this.selectionStart;
                const end = this.selectionEnd;
                this.value = this.value.substring(0, start) + '    ' + this.value.substring(end);
                this.selectionStart = this.selectionEnd = start + 4;
                refreshEditorUI();
            }
        });
        document.getElementById('code-editor').addEventListener('input', function() {
            refreshEditorUI();
        });
        document.getElementById('code-editor').addEventListener('scroll', function() {
            document.getElementById('code-gutter').scrollTop = this.scrollTop;
        });

        function refreshEditorUI() {
            const code = document.getElementById('code-editor').value || '';
            const lines = code.split('\n');
            const gutter = document.getElementById('code-gutter');
            const html = lines.map((_, idx) => {
                const ln = idx + 1;
                const set = editorBps.has(ln) ? ' set' : '';
                return `<div class="gutter-line" data-line="${ln}"><span class="gutter-num">${ln}</span><span class="gutter-bp${set}" title="Toggle breakpoint"></span></div>`;
            }).join('');
            gutter.innerHTML = html || '<div class="gutter-line"><span class="gutter-num">1</span><span class="gutter-bp"></span></div>';
            // Wire click handlers
            gutter.querySelectorAll('.gutter-line').forEach(el => {
                el.addEventListener('click', (e) => {
                    // Only toggle when clicking left side (bp or number). Any click in line toggles for simplicity.
                    const line = parseInt(el.getAttribute('data-line'), 10);
                    toggleBreakpoint(line);
                });
            });
        }

        function toggleBreakpoint(line) {
            if (editorBps.has(line)) editorBps.delete(line); else editorBps.add(line);
            // Reflect in UI
            const el = document.querySelector(`.gutter-line[data-line="${line}"] .gutter-bp`);
            if (el) el.classList.toggle('set');
            // Sync to debug-bps input
            const list = Array.from(editorBps).sort((a,b)=>a-b).join(',');
            document.getElementById('debug-bps').value = list;
        }

        function parseBpsInput() {
            const raw = (document.getElementById('debug-bps').value || '').split(',');
            return raw.map(x => parseInt(x.trim(), 10)).filter(x => !isNaN(x));
        }

        function syncEditorBpsFromInput() {
            const vals = parseBpsInput();
            vals.forEach(v => editorBps.add(v));
            refreshEditorUI();
        }
        
        // Helper function to determine difficulty
        function getDifficulty(problemName) {
            const easy = ['summation', 'palindrome', 'second_largest', 'two_sum', 'balanced_brackets', 'binary_search', 'climb_stairs'];
            const hard = ['three_sum', 'min_window_substring', 'longest_palindromic_substring', 'number_of_islands', 'coin_change', 'product_except_self'];
            
            if (easy.includes(problemName)) return 'easy';
            if (hard.includes(problemName)) return 'hard';
            return 'medium';
        }
        
        // Timer functions
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerPaused = false;
            problemStartTime = Date.now() - (timerSeconds * 1000);
            updateTimerBadgeState();
            timerInterval = setInterval(() => {
                if (!timerPaused) {
                    timerSeconds++;
                    updateTimerDisplay();
                    updateTimeStats();
                }
            }, 1000);
        }
        
        function pauseTimer() {
            timerPaused = !timerPaused;
            updateTimerBadgeState();
            const pauseBtn = document.getElementById('timer-pause');
            if (pauseBtn) {
                pauseBtn.textContent = timerPaused ? '‚ñ∂' : '‚è∏';
                pauseBtn.title = timerPaused ? 'Resume timer' : 'Pause timer';
            }
        }
        
        function resetTimer() {
            // Save current session if there was time
            if (timerSeconds > 0 && currentProblem) {
                saveTimeSession(currentProblem.name, timerSeconds, false);
            }
            timerSeconds = 0;
            timerPaused = false;
            problemStartTime = Date.now();
            updateTimerDisplay();
            updateTimerBadgeState();
            updateTimeStats();
        }
        
        function updateTimerBadgeState() {
            const badge = document.getElementById('timer-badge');
            if (badge) {
                if (timerPaused) {
                    badge.classList.add('paused');
                } else {
                    badge.classList.remove('paused');
                }
            }
        }
        
        function updateTimerDisplay() {
            const mins = Math.floor(timerSeconds / 60);
            const secs = timerSeconds % 60;
            document.getElementById('timer').textContent = 
                `‚è±Ô∏è ${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }
        
        // Time tracking functions
        function saveTimeSession(problemName, seconds, solved) {
            const session = {
                problem: problemName,
                time: seconds,
                solved: solved,
                timestamp: new Date().toISOString(),
                language: currentLanguage
            };
            timeHistory.unshift(session);
            // Keep only last 50 sessions
            if (timeHistory.length > 50) {
                timeHistory = timeHistory.slice(0, 50);
            }
            localStorage.setItem('timeHistory', JSON.stringify(timeHistory));
            updateTimeStats();
            renderSessionHistory();
        }
        
        function updateTimeStats() {
            // Current session time
            document.getElementById('stat-current').textContent = formatTime(timerSeconds);
            
            // Total time across all sessions
            const totalSeconds = timeHistory.reduce((sum, s) => sum + s.time, 0);
            document.getElementById('stat-total').textContent = formatTime(totalSeconds);
            
            // Problems solved (sessions marked as solved)
            const solvedCount = timeHistory.filter(s => s.solved).length;
            document.getElementById('stat-solved').textContent = solvedCount;
            
            // Average time per solved problem
            if (solvedCount > 0) {
                const avgSeconds = Math.floor(totalSeconds / solvedCount);
                document.getElementById('stat-avg').textContent = formatTime(avgSeconds);
            } else {
                document.getElementById('stat-avg').textContent = '--:--';
            }
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }
        
        function renderSessionHistory() {
            const list = document.getElementById('session-history-list');
            if (timeHistory.length === 0) {
                list.innerHTML = '<div style="color: #64748b; padding: 12px; text-align: center;">No sessions yet. Start solving problems!</div>';
                return;
            }
            
            list.innerHTML = timeHistory.slice(0, 10).map(session => {
                const date = new Date(session.timestamp);
                const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const icon = session.solved ? '‚úÖ' : '‚è±Ô∏è';
                return `
                    <div class="session-item">
                        <span class="session-problem">${icon} ${session.problem.replace(/_/g, ' ')}</span>
                        <span class="session-time">${formatTime(session.time)} ‚Ä¢ ${timeStr}</span>
                    </div>
                `;
            }).join('');
        }
        
        function clearTimeHistory() {
            if (confirm('Are you sure you want to clear all time history? This cannot be undone.')) {
                timeHistory = [];
                localStorage.removeItem('timeHistory');
                updateTimeStats();
                renderSessionHistory();
            }
        }
        
        // Notepad functions
        function saveNotepadContent() {
            if (!currentProblem) return;
            const textarea = document.getElementById('notepad-textarea');
            const noteKey = `notepad_${currentProblem.name}`;
            localStorage.setItem(noteKey, textarea.value);
        }
        
        function loadNotepadContent() {
            if (!currentProblem) return;
            const textarea = document.getElementById('notepad-textarea');
            const noteKey = `notepad_${currentProblem.name}`;
            const savedNotes = localStorage.getItem(noteKey);
            
            if (savedNotes) {
                textarea.value = savedNotes;
            } else {
                // Load template for new problems
                textarea.value = PROBLEM_SOLVING_TEMPLATE;
            }
        }
        
        function loadTemplate() {
            if (confirm('Load the problem-solving template? This will replace your current notes.')) {
                const textarea = document.getElementById('notepad-textarea');
                textarea.value = PROBLEM_SOLVING_TEMPLATE;
                saveNotepadContent();
            }
        }
        
        function clearNotepad() {
            if (confirm('Clear all notes for this problem? This cannot be undone.')) {
                const textarea = document.getElementById('notepad-textarea');
                textarea.value = '';
                saveNotepadContent();
            }
        }
        
        function toggleNotepad() {
            const body = document.getElementById('notepad-body');
            const btn = document.getElementById('toggle-notepad');
            const hidden = body.classList.contains('hidden');
            
            if (hidden) {
                body.classList.remove('hidden');
                btn.textContent = 'Hide notepad';
                notepadVisible = true;
            } else {
                body.classList.add('hidden');
                btn.textContent = 'Show notepad';
                notepadVisible = false;
            }
        }
        
        // Cheat sheet functions
        function renderCheatSheet(language) {
            const content = document.getElementById('cheatsheet-content');
            const title = document.getElementById('cheatsheet-title');
            const section = document.getElementById('cheatsheet-section');
            
            const langNames = {
                'python': 'üêç Python',
                'javascript': 'üìú JavaScript',
                'java': '‚òï Java'
            };
            
            title.textContent = `üìö ${langNames[language] || language} Cheat Sheet`;
            content.innerHTML = CHEAT_SHEETS[language] || '<p>No cheat sheet available for this language.</p>';
            
            // Show section (always show the section, but body might be hidden)
            section.classList.remove('hidden');
            
            // Set body visibility based on state
            const body = document.getElementById('cheatsheet-body');
            const btn = document.getElementById('toggle-cheatsheet');
            if (cheatsheetVisible) {
                body.classList.remove('hidden');
                btn.textContent = 'Hide cheat sheet';
            } else {
                body.classList.add('hidden');
                btn.textContent = 'Show cheat sheet';
            }
        }
        
        function toggleCheatSheet() {
            const body = document.getElementById('cheatsheet-body');
            const btn = document.getElementById('toggle-cheatsheet');
            const hidden = body.classList.contains('hidden');
            
            if (hidden) {
                body.classList.remove('hidden');
                btn.textContent = 'Hide cheat sheet';
                cheatsheetVisible = true;
            } else {
                body.classList.add('hidden');
                btn.textContent = 'Show cheat sheet';
                cheatsheetVisible = false;
            }
        }
        
        // Toggle lecture section
        function toggleLecture() {
            const body = document.getElementById('lecture-body');
            const btn = document.getElementById('toggle-lecture');
            const hidden = body.classList.contains('hidden');
            
            if (hidden) {
                body.classList.remove('hidden');
                btn.textContent = 'Hide lecture';
                lectureVisible = true;
            } else {
                body.classList.add('hidden');
                btn.textContent = 'Show lecture';
                lectureVisible = false;
            }
        }
        
        // Load lecture content
        function loadLecture() {
            const lectureBody = document.getElementById('lecture-body');
            lectureBody.innerHTML = LECTURE_CONTENT;
            
            // Set visibility based on state
            const lectureSection = document.getElementById('lecture-section');
            lectureSection.classList.remove('hidden');
            
            if (!lectureVisible) {
                document.getElementById('lecture-body').classList.add('hidden');
                document.getElementById('toggle-lecture').textContent = 'Show lecture';
            }
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + Enter to run tests
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                submitSolution();
            }
        });

        // Onboarding tour
        const tourSteps = [
            { selector: '.sidebar', text: '<strong>1) Choose a problem</strong><br/>Pick a problem from the list to load its stub, tests, and hints.' },
            { selector: '#problem-description', text: '<strong>2) Read the description</strong><br/>Understand the function contract and sample cases.' },
            { selector: '#lecture-section', text: '<strong>3) Learn Problem-Solving</strong><br/>Read the lecture on how to think through problems and build logic from scratch.' },
            { selector: '#notepad-section', text: '<strong>4) Plan with Notepad</strong><br/>Use the problem-solving framework to think through your approach before coding.' },
            { selector: '#cheatsheet-section', text: '<strong>5) Language Cheat Sheet</strong><br/>Quick reference for common methods, data structures, and syntax patterns.' },
            { selector: '#hints-section', text: '<strong>6) Use Hints</strong><br/>Reveal step-by-step tips and pseudocode if you get stuck.' },
            { selector: '#code-editor', text: '<strong>7) Write code</strong><br/>Implement the function; use Tab for indentation.' },
            { selector: '#submit-btn', text: '<strong>8) Run tests</strong><br/>Click Run or press Ctrl+Enter to test your code.' },
            { selector: '#debug-section', text: '<strong>9) Debug</strong><br/>Set breakpoints and run the debugger to step through your code.' },
            { selector: '#glossary-section', text: '<strong>10) Glossary</strong><br/>Search key terms and concepts relevant to the problem.' },
        ];
        let tourIdx = 0;
        let tourActive = false;

        function startTour(force=false) {
            if (!force && localStorage.getItem('tourSeen') === '1') {
                return;
            }
            tourIdx = 0;
            tourActive = true;
            
            // Set the content FIRST before showing the overlay
            showTourStep();
            
            // Then show the overlay
            const ov = document.getElementById('tour-overlay');
            if (ov) { 
                ov.classList.remove('hidden'); 
                ov.style.display = 'flex'; 
            }
        }

        function endTour(save=true) {
            tourActive = false;
            const ov = document.getElementById('tour-overlay');
            if (ov) { ov.classList.add('hidden'); ov.style.display = 'none'; }
            removeHighlights();
            if (save) localStorage.setItem('tourSeen', '1');
        }

        function removeHighlights() {
            document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight'));
        }

        function showTourStep() {
            const total = tourSteps.length;
            if (tourIdx < 0) tourIdx = 0;
            if (tourIdx >= total) tourIdx = total - 1;

            const step = tourSteps[tourIdx];
            
            removeHighlights();
            
            // Highlight element if selector exists
            if (step && step.selector) {
                const el = document.querySelector(step.selector);
                if (el) {
                    el.classList.add('tour-highlight');
                    try { el.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (_) {}
                }
            }
            
            // Update text content with HTML
            const txt = document.getElementById('tour-text');
            if (txt && step && step.text) {
                txt.innerHTML = step.text;
            }
            
            // Update buttons
            const prevBtn = document.getElementById('tour-prev');
            if (prevBtn) prevBtn.disabled = tourIdx === 0;
            
            const nextBtn = document.getElementById('tour-next');
            if (nextBtn) nextBtn.textContent = (tourIdx === total - 1) ? 'Finish' : 'Next';
        }
        
        // Fetch glossary
        async function ensureGlossary() {
            if (glossaryCache) return;
            try {
                const res = await fetch('/api/glossary');
                glossaryCache = await res.json();
            } catch (e) {
                console.error('Failed to load glossary:', e);
                glossaryCache = {};
            }
        }

        // Render glossary for current problem
        function renderGlossary(problemTerms) {
            const section = document.getElementById('glossary-section');
            const body = document.getElementById('glossary-body');
            const list = document.getElementById('glossary-list');
            const search = document.getElementById('glossary-search');

            if (!glossaryCache || Object.keys(glossaryCache).length === 0) {
                section.classList.add('hidden');
                return;
            }

            section.classList.remove('hidden');
            if (glossaryVisibleState) {
                body.classList.remove('hidden');
                document.getElementById('toggle-glossary').textContent = 'Hide glossary';
            } else {
                body.classList.add('hidden');
                document.getElementById('toggle-glossary').textContent = 'Show glossary';
            }

            const items = buildGlossaryItems(problemTerms, search.value || '');
            list.innerHTML = items.length ? items.join('') : '<div>No matching terms.</div>';

            // Wire up search
            search.oninput = () => {
                const filtered = buildGlossaryItems(problemTerms, search.value || '');
                list.innerHTML = filtered.length ? filtered.join('') : '<div>No matching terms.</div>';
            };
        }

        function buildGlossaryItems(problemTerms, filter) {
            const normalizedFilter = filter.trim().toLowerCase();
            const entries = Object.entries(glossaryCache || {});

            // Prefer problem-specific terms first, then others (for discovery)
            const preferred = new Set(problemTerms.map(t => t.toLowerCase()));
            const sorted = entries.sort(([a], [b]) => {
                const pa = preferred.has(a.toLowerCase()) ? 0 : 1;
                const pb = preferred.has(b.toLowerCase()) ? 0 : 1;
                if (pa !== pb) return pa - pb;
                return a.localeCompare(b);
            });

            const result = [];
            for (const [term, def] of sorted) {
                const termL = term.toLowerCase();
                const defL = String(def).toLowerCase();
                if (normalizedFilter && !termL.includes(normalizedFilter) && !defL.includes(normalizedFilter)) {
                    continue;
                }
                result.push(
                    `<div class="glossary-item">
                        <div class="term-title">${term}</div>
                        <div class="term-definition">${def}</div>
                        <div class="term-actions">
                            <button class="btn-copy" onclick="copyText('${encodeURIComponent(def)}', this)">Copy definition</button>
                        </div>
                    </div>`
                );
            }
            return result;
        }

        // Copy helper used by glossary items
        function copyText(encoded, btnEl) {
            const text = decodeURIComponent(encoded);
            const original = btnEl.textContent;
            navigator.clipboard.writeText(text).then(() => {
                btnEl.textContent = '‚úì Copied!';
                btnEl.classList.add('copied');
                setTimeout(() => { btnEl.textContent = original; btnEl.classList.remove('copied'); }, 1500);
            }).catch(() => {
                // Fallback
                const ta = document.createElement('textarea');
                ta.value = text;
                ta.style.position = 'fixed';
                ta.style.opacity = '0';
                document.body.appendChild(ta);
                ta.select();
                try { document.execCommand('copy'); btnEl.textContent = '‚úì Copied!'; btnEl.classList.add('copied');
                    setTimeout(() => { btnEl.textContent = original; btnEl.classList.remove('copied'); }, 1500);
                } finally { document.body.removeChild(ta); }
            });
        }

        // Guided debug helper
        document.getElementById('debug-guide').onclick = async () => {
            // Ensure debugger panel open
            const body = document.getElementById('debug-body');
            if (body.classList.contains('hidden')) {
                document.getElementById('toggle-debug').click();
            }
            const code = document.getElementById('code-editor').value || '';
            const lines = code.split('\n');
            const bps = [];
            for (let i = 0; i < lines.length && bps.length < 3; i++) {
                const t = lines[i].trim();
                if (t && !t.startsWith('#')) bps.push(i + 1);
            }
            document.getElementById('debug-bps').value = bps.join(',');
            // Reflect guided breakpoints in gutter too
            syncEditorBpsFromInput();
            runDebug();
        };

        // Tour buttons and Help (direct bind only for open-tour)
        const btnOpenTour = document.getElementById('open-tour');
        if (btnOpenTour) btnOpenTour.onclick = () => startTour(true);

        // Direct handlers for tour controls to ensure they work
        const btnTourSkip = document.getElementById('tour-skip');
        if (btnTourSkip) btnTourSkip.addEventListener('click', (e) => { e.preventDefault(); endTour(true); });
        const btnTourPrev = document.getElementById('tour-prev');
        if (btnTourPrev) btnTourPrev.addEventListener('click', (e) => { e.preventDefault(); if (tourIdx > 0) { tourIdx--; showTourStep(); } });
        const btnTourNext = document.getElementById('tour-next');
        if (btnTourNext) btnTourNext.addEventListener('click', (e) => { e.preventDefault(); if (tourIdx < tourSteps.length - 1) { tourIdx++; showTourStep(); } else { endTour(true); } });

        // Initialize
        loadProblems();
        
        // Initialize time stats display
        updateTimeStats();
        renderSessionHistory();
    </script>
</body>
</html>
